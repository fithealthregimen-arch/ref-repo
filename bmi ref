<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
<body>

<style>
    .bmi-calculator-wrapper * {
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box !important;
        font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif !important;
    }

    .bmi-wrapper {
        --primary-blue: #1E40AF !important;
        --secondary-blue: #2563EB !important;
        --accent-blue: #3B82F6 !important;
        --light-blue: #EBF8FF !important;
        --bg-gradient: linear-gradient(135deg, #F8FAFC, #F1F5F9) !important;
        --text-primary: #0F172A !important;
        --text-secondary: #334155 !important;
        --text-muted: #64748B !important;
        --border-color: #E2E8F0 !important;
        --card-bg: #FFFFFF !important;
        --success-color: #059669 !important;
        --warning-color: #D97706 !important;
        --error-color: #DC2626 !important;
        
        background: var(--bg-gradient) !important;
        color: var(--text-primary) !important;
        line-height: 1.5 !important;
        padding: 15px !important;
        min-height: 100vh !important;
        font-size: 16px !important;
    }

    .bmi-main-container {
        max-width: 1200px !important;
        margin: 0 auto !important;
        background: var(--card-bg) !important;
        border-radius: 20px !important;
        box-shadow: 0 25px 50px -12px rgba(30, 64, 175, 0.15) !important;
        border: 1px solid var(--border-color) !important;
        overflow: hidden !important;
        position: relative !important;
    }

    .bmi-main-container::before {
        content: '' !important;
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        height: 6px !important;
        background: linear-gradient(90deg, var(--primary-blue), var(--secondary-blue), var(--accent-blue)) !important;
    }

    .bmi-header-section {
        text-align: center !important;
        padding: 25px 20px !important;
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        color: white !important;
        position: relative !important;
    }

    .bmi-header-section::after {
        content: '' !important;
        position: absolute !important;
        bottom: -1px !important;
        left: 0 !important;
        right: 0 !important;
        height: 15px !important;
        background: var(--card-bg) !important;
        border-radius: 15px 15px 0 0 !important;
    }

    .bmi-main-title {
        font-size: 32px !important;
        font-weight: 800 !important;
        margin-bottom: 8px !important;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
    }

    .bmi-subtitle {
        font-size: 16px !important;
        opacity: 0.9 !important;
        max-width: 600px !important;
        margin: 0 auto !important;
    }

    .bmi-warning-box {
        background: #EBF8FF !important;
        border: 2px solid var(--accent-blue) !important;
        border-radius: 12px !important;
        padding: 16px 20px !important;
        margin: 20px 0 !important;
        font-size: 14px !important;
        font-weight: 600 !important;
        color: var(--primary-blue) !important;
        display: flex !important;
        align-items: center !important;
        gap: 10px !important;
    }

    .bmi-calculator-form {
        padding: 25px 20px !important;
        background: var(--card-bg) !important;
    }

    .bmi-form-grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
        gap: 18px !important;
        margin-bottom: 20px !important;
    }

    .bmi-input-group {
        background: linear-gradient(145deg, #FFFFFF, #F8FAFC) !important;
        padding: 18px !important;
        border-radius: 12px !important;
        border: 2px solid var(--border-color) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    .bmi-input-group:hover {
        border-color: var(--accent-blue) !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 10px 25px rgba(30, 64, 175, 0.1) !important;
    }

    .bmi-input-label {
        display: flex !important;
        align-items: center !important;
        gap: 10px !important;
        font-weight: 700 !important;
        color: var(--text-primary) !important;
        font-size: 16px !important;
        margin-bottom: 12px !important;
    }

    .bmi-input-icon {
        font-size: 20px !important;
        padding: 8px !important;
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        border-radius: 10px !important;
        color: white !important;
        min-width: 36px !important;
        text-align: center !important;
    }

    .bmi-input-field, .bmi-select-field {
        width: 100% !important;
        padding: 16px 20px !important;
        font-size: 16px !important;
        font-weight: 500 !important;
        border: 2px solid var(--border-color) !important;
        border-radius: 12px !important;
        background: var(--card-bg) !important;
        color: var(--text-primary) !important;
        transition: all 0.3s ease !important;
        outline: none !important;
    }

    .bmi-input-field:focus, .bmi-select-field:focus {
        border-color: var(--primary-blue) !important;
        box-shadow: 0 0 0 4px rgba(30, 64, 175, 0.1) !important;
        transform: translateY(-1px) !important;
    }

    .bmi-unit-toggle {
        display: flex !important;
        background: var(--light-blue) !important;
        border-radius: 12px !important;
        padding: 4px !important;
        margin-top: 12px !important;
        border: 1px solid var(--border-color) !important;
    }

    .bmi-unit-btn {
        flex: 1 !important;
        padding: 12px 16px !important;
        border: none !important;
        background: transparent !important;
        color: var(--text-secondary) !important;
        font-weight: 600 !important;
        font-size: 14px !important;
        border-radius: 8px !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }

    .bmi-unit-btn.active {
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        color: white !important;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3) !important;
        transform: translateY(-1px) !important;
    }

    .bmi-help-text {
        color: var(--text-muted) !important;
        font-size: 14px !important;
        margin-top: 8px !important;
        line-height: 1.5 !important;
    }

    .bmi-calculate-btn {
        width: 100% !important;
        padding: 20px 40px !important;
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        color: white !important;
        border: none !important;
        border-radius: 16px !important;
        font-size: 18px !important;
        font-weight: 700 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 12px !important;
        box-shadow: 0 8px 25px rgba(30, 64, 175, 0.3) !important;
    }

    .bmi-calculate-btn:hover {
        transform: translateY(-3px) !important;
        box-shadow: 0 12px 35px rgba(30, 64, 175, 0.4) !important;
    }

    .bmi-results-container {
        margin-top: 30px !important;
        opacity: 0 !important;
        transform: translateY(20px) !important;
        transition: all 0.5s ease !important;
        max-height: 0 !important;
        overflow: hidden !important;
    }

    .bmi-results-container.show {
        opacity: 1 !important;
        transform: translateY(0) !important;
        max-height: 10000px !important;
    }

    .bmi-results-header {
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        color: white !important;
        padding: 25px 30px !important;
        border-radius: 16px 16px 0 0 !important;
        text-align: center !important;
    }

    .bmi-results-title {
        font-size: 24px !important;
        font-weight: 700 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 12px !important;
    }

    .bmi-main-results {
        display: grid !important;
        grid-template-columns: 1fr 1fr !important;
        background: linear-gradient(145deg, #F8FAFC, var(--card-bg)) !important;
        border-bottom: 1px solid var(--border-color) !important;
    }

    .bmi-result-item {
        padding: 30px !important;
        text-align: center !important;
        border-right: 1px solid var(--border-color) !important;
    }

    .bmi-result-item:last-child {
        border-right: none !important;
    }

    .bmi-result-number {
        font-size: 42px !important;
        font-weight: 800 !important;
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
        margin-bottom: 8px !important;
        display: block !important;
    }

    .bmi-result-label {
        color: var(--text-secondary) !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        text-transform: uppercase !important;
        letter-spacing: 0.5px !important;
    }

    /* BMI Slider Visualization - Modern Style */
    .bmi-slider-container {
        padding: 40px 30px !important;
        background: linear-gradient(145deg, #FFFFFF, #F8FAFC) !important;
        border-bottom: 1px solid var(--border-color) !important;
    }

    .bmi-slider-result {
        text-align: center !important;
        margin-bottom: 30px !important;
    }

    .bmi-result-value {
        font-size: 64px !important;
        font-weight: 800 !important;
        background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
        line-height: 1 !important;
    }

    .bmi-result-category {
        font-size: 24px !important;
        font-weight: 700 !important;
        margin-top: 10px !important;
        text-transform: uppercase !important;
        letter-spacing: 1px !important;
    }

    .bmi-slider-track {
        position: relative !important;
        width: 100% !important;
        max-width: 700px !important;
        margin: 0 auto 50px !important;
        height: 50px !important;
        display: flex !important;
        border-radius: 25px !important;
        overflow: hidden !important;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1) !important;
    }

    .bmi-slider-segment {
        height: 100% !important;
        transition: all 0.3s ease !important;
    }

    .bmi-slider-segment:hover {
        opacity: 0.9 !important;
        transform: scaleY(1.05) !important;
    }

    .bmi-underweight {
        background: linear-gradient(135deg, #F59E0B, #FBBF24) !important;
    }

    .bmi-healthy {
        background: linear-gradient(135deg, #059669, #10B981) !important;
    }

    .bmi-overweight {
        background: linear-gradient(135deg, #D97706, #F59E0B) !important;
    }

    .bmi-obese {
        background: linear-gradient(135deg, #DC2626, #EF4444) !important;
    }

    .bmi-slider-labels {
        position: absolute !important;
        width: 100% !important;
        top: 60px !important;
        display: flex !important;
        justify-content: space-between !important;
    }

    .bmi-slider-labels span {
        position: absolute !important;
        transform: translateX(-50%) !important;
        font-size: 13px !important;
        font-weight: 700 !important;
        color: var(--text-secondary) !important;
    }

    .bmi-slider-indicator {
        position: absolute !important;
        top: -15px !important;
        transform: translateX(-50%) !important;
        transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
        z-index: 10 !important;
    }

    .bmi-indicator-dot {
        width: 24px !important;
        height: 24px !important;
        border-radius: 50% !important;
        border: 4px solid white !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
        position: relative !important;
        margin: 0 auto 8px !important;
    }

    .bmi-indicator-pulse {
        position: absolute !important;
        top: -4px !important;
        left: -4px !important;
        right: -4px !important;
        bottom: -4px !important;
        border-radius: 50% !important;
        opacity: 0.3 !important;
        animation: bmiPulse 2s infinite !important;
    }

    @keyframes bmiPulse {
        0%, 100% {
            transform: scale(1) !important;
            opacity: 0.3 !important;
        }
        50% {
            transform: scale(1.5) !important;
            opacity: 0 !important;
        }
    }

    .bmi-indicator-label {
        color: white !important;
        padding: 6px 14px !important;
        border-radius: 20px !important;
        font-size: 16px !important;
        font-weight: 700 !important;
        white-space: nowrap !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
    }

    /* BMI Classification Box */
    .bmi-classification-box {
        background: white !important;
        padding: 25px !important;
        border-radius: 12px !important;
        max-width: 700px !important;
        margin: 30px auto !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
        border: 2px solid var(--border-color) !important;
    }

    .bmi-classification-title {
        font-size: 18px !important;
        font-weight: 700 !important;
        color: var(--text-primary) !important;
        margin: 0 0 20px 0 !important;
        text-align: center !important;
    }

    .bmi-classification-grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)) !important;
        gap: 15px !important;
    }

    .bmi-classification-item {
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        gap: 8px !important;
        padding: 15px !important;
        border-radius: 8px !important;
        background: var(--card-bg) !important;
        transition: all 0.3s ease !important;
        border: 2px solid transparent !important;
    }

    .bmi-classification-item.active {
        background: rgba(30, 64, 175, 0.05) !important;
        border-color: var(--primary-blue) !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.15) !important;
    }

    .bmi-class-dot {
        width: 16px !important;
        height: 16px !important;
        border-radius: 50% !important;
    }

    .bmi-class-label {
        font-size: 14px !important;
        font-weight: 600 !important;
        color: var(--text-primary) !important;
        text-align: center !important;
    }

    .bmi-class-range {
        font-size: 13px !important;
        font-weight: 700 !important;
        color: var(--text-secondary) !important;
    }

    /* Action Buttons */
    .bmi-action-buttons {
        display: flex !important;
        gap: 12px !important;
        justify-content: center !important;
        margin: 30px 0 !important;
        flex-wrap: wrap !important;
    }

    .bmi-action-btn {
        display: inline-flex !important;
        align-items: center !important;
        gap: 8px !important;
        padding: 12px 24px !important;
        border: 2px solid var(--primary-blue) !important;
        background: white !important;
        color: var(--primary-blue) !important;
        border-radius: 8px !important;
        font-size: 15px !important;
        font-weight: 600 !important;
        cursor: pointer !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 2px 6px rgba(30, 64, 175, 0.1) !important;
    }

    .bmi-action-btn:hover {
        background: var(--primary-blue) !important;
        color: white !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.25) !important;
    }

    .bmi-action-btn svg {
        stroke-width: 2.5 !important;
    }

    /* BMI Metrics Grid */
    .bmi-metrics-grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)) !important;
        gap: 20px !important;
        max-width: 900px !important;
        margin: 30px auto !important;
        padding: 0 30px !important;
    }

    .bmi-metric-card {
        background: linear-gradient(145deg, #FFFFFF, #F8FAFC) !important;
        padding: 25px !important;
        border-radius: 12px !important;
        text-align: center !important;
        border: 2px solid var(--border-color) !important;
        transition: all 0.3s ease !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05) !important;
    }

    .bmi-metric-card:hover {
        transform: translateY(-4px) !important;
        box-shadow: 0 8px 20px rgba(30, 64, 175, 0.15) !important;
        border-color: var(--primary-blue) !important;
    }

    .bmi-metric-icon {
        font-size: 36px !important;
        margin-bottom: 12px !important;
    }

    .bmi-metric-label {
        font-size: 13px !important;
        font-weight: 600 !important;
        color: var(--text-secondary) !important;
        margin-bottom: 8px !important;
        text-transform: uppercase !important;
        letter-spacing: 0.5px !important;
    }

    .bmi-metric-value {
        font-size: 20px !important;
        font-weight: 800 !important;
        color: var(--primary-blue) !important;
        margin-bottom: 4px !important;
    }

    .bmi-metric-note {
        font-size: 12px !important;
        color: var(--text-secondary) !important;
        font-style: italic !important;
    }

    /* Details Section */
    .bmi-details-section {
        background: var(--card-bg) !important;
        padding: 25px 30px !important;
        border-bottom: 1px solid var(--border-color) !important;
    }

    .bmi-detail-row {
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        padding: 12px 0 !important;
        border-bottom: 1px solid #F1F5F9 !important;
    }

    .bmi-detail-row:last-child {
        border-bottom: none !important;
    }

    .bmi-detail-label {
        font-weight: 600 !important;
        color: var(--text-primary) !important;
    }

    .bmi-detail-value {
        color: var(--text-secondary) !important;
        font-weight: 500 !important;
    }

    /* Info Boxes */
    .bmi-info-box {
        background: var(--light-blue) !important;
        border: 1px solid var(--accent-blue) !important;
        border-radius: 12px !important;
        padding: 20px !important;
        margin: 20px 0 !important;
    }

    .bmi-info-title {
        font-weight: 700 !important;
        color: var(--primary-blue) !important;
        margin-bottom: 10px !important;
        font-size: 16px !important;
    }

    .bmi-info-text {
        color: var(--text-secondary) !important;
        line-height: 1.6 !important;
        font-size: 15px !important;
    }

    /* Tabs */
    .bmi-tabs {
        display: flex !important;
        gap: 10px !important;
        padding: 20px 30px 0 !important;
        background: var(--card-bg) !important;
        border-bottom: 2px solid var(--border-color) !important;
        flex-wrap: wrap !important;
    }

    .bmi-tab-btn {
        padding: 12px 20px !important;
        border: none !important;
        background: transparent !important;
        color: var(--text-secondary) !important;
        font-weight: 600 !important;
        font-size: 14px !important;
        cursor: pointer !important;
        border-bottom: 3px solid transparent !important;
        transition: all 0.3s ease !important;
        position: relative !important;
        bottom: -2px !important;
    }

    .bmi-tab-btn.active {
        color: var(--primary-blue) !important;
        border-bottom-color: var(--primary-blue) !important;
    }

    .bmi-tab-content {
        display: none !important;
        padding: 25px 30px !important;
        background: var(--card-bg) !important;
    }

    .bmi-tab-content.active {
        display: block !important;
        animation: fadeIn 0.3s ease !important;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Goal Cards */
    .bmi-goals-grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
        gap: 16px !important;
        margin-top: 15px !important;
    }

    .bmi-goal-card {
        background: var(--card-bg) !important;
        padding: 20px !important;
        border-radius: 12px !important;
        border: 2px solid var(--border-color) !important;
        transition: all 0.3s ease !important;
    }

    .bmi-goal-card:hover {
        border-color: var(--accent-blue) !important;
        transform: translateY(-2px) !important;
        box-shadow: 0 8px 20px rgba(30, 64, 175, 0.1) !important;
    }

    .bmi-goal-title {
        font-weight: 700 !important;
        color: var(--primary-blue) !important;
        margin-bottom: 10px !important;
        font-size: 16px !important;
    }

    .bmi-goal-value {
        font-size: 24px !important;
        font-weight: 800 !important;
        color: var(--text-primary) !important;
        margin-bottom: 5px !important;
    }

    .bmi-goal-subtitle {
        font-size: 13px !important;
        color: var(--text-muted) !important;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
        .bmi-wrapper {
            padding: 8px !important;
        }
        
        .bmi-main-title {
            font-size: 26px !important;
        }
        
        .bmi-calculator-form {
            padding: 18px 12px !important;
        }
        
        .bmi-form-grid {
            grid-template-columns: 1fr !important;
            gap: 15px !important;
        }
        
        .bmi-input-group {
            padding: 15px !important;
        }
        
        .bmi-main-results {
            grid-template-columns: 1fr !important;
        }
        
        .bmi-result-item {
            border-right: none !important;
            border-bottom: 1px solid var(--border-color) !important;
            padding: 25px !important;
        }
        
        .bmi-result-item:last-child {
            border-bottom: none !important;
        }
        
        .bmi-goals-grid {
            grid-template-columns: 1fr !important;
        }

        .bmi-tabs {
            padding: 15px 15px 0 !important;
        }

        .bmi-result-value {
            font-size: 48px !important;
        }

        .bmi-result-category {
            font-size: 20px !important;
        }

        .bmi-slider-track {
            height: 40px !important;
            max-width: 100% !important;
        }

        .bmi-slider-labels span {
            font-size: 11px !important;
        }

        .bmi-indicator-label {
            font-size: 14px !important;
            padding: 4px 10px !important;
        }

        .bmi-classification-grid {
            grid-template-columns: 1fr 1fr !important;
        }

        .bmi-action-buttons {
            flex-direction: column !important;
        }

        .bmi-action-btn {
            width: 100% !important;
            justify-content: center !important;
        }

        .bmi-metrics-grid {
            grid-template-columns: 1fr !important;
            padding: 0 15px !important;
        }

        .bmi-slider-container,
        .bmi-classification-box {
            padding: 20px 15px !important;
        }

        .bmi-tab-btn {
            font-size: 13px !important;
            padding: 10px 15px !important;
        }
    }

    @media print {
        .bmi-action-buttons {
            display: none !important;
        }

        .bmi-calculator-form,
        .sf-calculator-header {
            display: none !important;
        }

        .bmi-results-section {
            box-shadow: none !important;
            border: 1px solid #ddd !important;
            page-break-inside: avoid !important;
        }

        .bmi-slider-indicator {
            animation: none !important;
        }

        .bmi-indicator-pulse {
            animation: none !important;
            opacity: 0 !important;
        }
    }
</style>

<div class="bmi-wrapper">
    <div class="bmi-main-container">
        <div class="bmi-header-section">
            <h1 class="bmi-main-title">BMI Calculator</h1>
            <p class="bmi-subtitle">Calculate your Body Mass Index with age-adjusted analysis and personalized health insights</p>
        </div>

        <div class="bmi-calculator-form">
            <div class="bmi-warning-box">
                ‚ÑπÔ∏è <strong>Important:</strong> BMI is a screening tool. This calculator includes age and gender adjustments for more accurate health assessments.
            </div>

            <form id="bmiCalculatorForm">
                <div class="bmi-form-grid">
                    <!-- Age Type Selection -->
                    <div class="bmi-input-group" style="grid-column: 1 / -1;">
                        <label class="bmi-input-label">
                            <span class="bmi-input-icon">üë§</span>
                            Who is this calculation for?
                        </label>
                        <div class="bmi-unit-toggle">
                            <button type="button" class="bmi-unit-btn active" data-type="adult">Adult (18+)</button>
                            <button type="button" class="bmi-unit-btn" data-type="child">Child/Teen (2-20)</button>
                        </div>
                    </div>

                    <!-- Gender -->
                    <div class="bmi-input-group">
                        <label class="bmi-input-label">
                            <span class="bmi-input-icon">‚ö•</span>
                            Gender
                        </label>
                        <select id="genderInput" class="bmi-select-field" required>
                            <option value="">Select Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                        <div class="bmi-help-text">Affects body composition and BMI interpretation</div>
                    </div>

                    <!-- Age -->
                    <div class="bmi-input-group">
                        <label class="bmi-input-label">
                            <span class="bmi-input-icon">üéÇ</span>
                            Age
                        </label>
                        <input type="number" id="ageInput" class="bmi-input-field" placeholder="Enter age" min="2" max="120" required>
                        <div class="bmi-help-text" id="ageHelp">Age adjusts BMI interpretation</div>
                    </div>

                    <!-- Height -->
                    <div class="bmi-input-group">
                        <label class="bmi-input-label">
                            <span class="bmi-input-icon">üìè</span>
                            Height
                        </label>
                        <div id="heightFeetInches" style="display: flex; gap: 10px;">
                            <input type="number" id="heightFeet" class="bmi-input-field" placeholder="Feet" min="2" max="8" style="flex: 1;">
                            <input type="number" id="heightInches" class="bmi-input-field" placeholder="Inches" min="0" max="11" step="0.1" style="flex: 1;">
                        </div>
                        <input type="number" id="heightCm" class="bmi-input-field" placeholder="Enter height in cm" min="50" max="250" style="display: none;">
                        <div class="bmi-unit-toggle">
                            <button type="button" class="bmi-unit-btn active" data-unit="imperial">Feet & Inches</button>
                            <button type="button" class="bmi-unit-btn" data-unit="metric">Centimeters</button>
                        </div>
                    </div>

                    <!-- Weight -->
                    <div class="bmi-input-group">
                        <label class="bmi-input-label">
                            <span class="bmi-input-icon">‚öñÔ∏è</span>
                            Weight
                        </label>
                        <input type="number" id="weightInput" class="bmi-input-field" placeholder="Enter weight" step="0.1" min="10" max="500" required>
                        <div class="bmi-unit-toggle">
                            <button type="button" class="bmi-unit-btn active" data-weight-unit="lbs">Pounds (lbs)</button>
                            <button type="button" class="bmi-unit-btn" data-weight-unit="kg">Kilograms (kg)</button>
                        </div>
                        <div class="bmi-help-text">Your current body weight</div>
                    </div>
                </div>

                <button type="submit" class="bmi-calculate-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 12l2 2 4-4"/>
                        <circle cx="12" cy="12" r="10"/>
                    </svg>
                    Calculate BMI
                </button>
            </form>

            <div id="resultsContainer" class="bmi-results-container">
                <!-- Results will be inserted here by JavaScript -->
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    // DOM Elements
    const form = document.getElementById('bmiCalculatorForm');
    const genderInput = document.getElementById('genderInput');
    const ageInput = document.getElementById('ageInput');
    const heightFeet = document.getElementById('heightFeet');
    const heightInches = document.getElementById('heightInches');
    const heightCm = document.getElementById('heightCm');
    const weightInput = document.getElementById('weightInput');
    const resultsContainer = document.getElementById('resultsContainer');
    
    // State
    let currentAgeType = 'adult';
    let currentHeightUnit = 'imperial';
    let currentWeightUnit = 'lbs';
    
    // Age Type Toggle
    const ageTypeButtons = document.querySelectorAll('[data-type]');
    ageTypeButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const type = this.getAttribute('data-type');
            if (type === currentAgeType) return;
            
            ageTypeButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            currentAgeType = type;
            
            // Update age limits and help text
            if (type === 'child') {
                ageInput.min = 2;
                ageInput.max = 20;
                ageInput.placeholder = 'Age 2-20';
                document.getElementById('ageHelp').textContent = 'Uses CDC growth charts for children';
            } else {
                ageInput.min = 18;
                ageInput.max = 120;
                ageInput.placeholder = 'Age 18+';
                document.getElementById('ageHelp').textContent = 'Age adjusts BMI interpretation';
            }
        });
    });
    
    // Height Unit Toggle
    const heightUnitButtons = document.querySelectorAll('[data-unit]');
    heightUnitButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const unit = this.getAttribute('data-unit');
            if (unit === currentHeightUnit) return;
            
            heightUnitButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            const heightFeetInches = document.getElementById('heightFeetInches');
            
            if (unit === 'metric') {
                heightFeetInches.style.display = 'none';
                heightCm.style.display = 'block';
                heightCm.required = true;
                heightFeet.required = false;
                heightInches.required = false;
            } else {
                heightFeetInches.style.display = 'flex';
                heightCm.style.display = 'none';
                heightCm.required = false;
                heightFeet.required = true;
                heightInches.required = true;
            }
            
            currentHeightUnit = unit;
        });
    });
    
    // Weight Unit Toggle
    const weightUnitButtons = document.querySelectorAll('[data-weight-unit]');
    weightUnitButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const unit = this.getAttribute('data-weight-unit');
            if (unit === currentWeightUnit) return;
            
            weightUnitButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Convert existing value
            const currentValue = parseFloat(weightInput.value);
            if (currentValue && !isNaN(currentValue)) {
                if (unit === 'kg') {
                    weightInput.value = (currentValue / 2.20462).toFixed(1);
                    weightInput.min = 10;
                    weightInput.max = 227;
                    weightInput.placeholder = 'Enter weight in kg';
                } else {
                    weightInput.value = (currentValue * 2.20462).toFixed(1);
                    weightInput.min = 22;
                    weightInput.max = 500;
                    weightInput.placeholder = 'Enter weight in lbs';
                }
            } else {
                if (unit === 'kg') {
                    weightInput.min = 10;
                    weightInput.max = 227;
                    weightInput.placeholder = 'Enter weight in kg';
                } else {
                    weightInput.min = 22;
                    weightInput.max = 500;
                    weightInput.placeholder = 'Enter weight in lbs';
                }
            }
            
            currentWeightUnit = unit;
        });
    });
    
    // Calculate BMI using standard formula
    // Formula: BMI = weight (kg) / height¬≤ (m¬≤)
    // Reference: Keys A, et al. (1972). Indices of relative weight and obesity. J Chronic Dis. 25(6):329-43
    function calculateBMI(weightKg, heightM) {
        if (heightM <= 0 || weightKg <= 0) return 0;
        return weightKg / (heightM * heightM);
    }
    
    // Get BMI Category for Adults (WHO/CDC Guidelines)
    // Reference: WHO (2000). Obesity: preventing and managing the global epidemic
    // CDC: https://www.cdc.gov/bmi/adult-calculator/bmi-categories.html
    function getBMICategory(bmi, age, gender) {
        // Age-adjusted BMI categories for older adults (65+)
        // Research shows slightly higher BMI may be healthier for seniors
        // Reference: Winter JE, et al. (2014) BMI and all-cause mortality in older adults
        if (age >= 65) {
            if (bmi < 23) return { name: 'Underweight', color: '#F59E0B', risk: 'Increased' };
            if (bmi < 28) return { name: 'Healthy Weight', color: '#059669', risk: 'Low' };
            if (bmi < 30) return { name: 'Overweight', color: '#D97706', risk: 'Moderate' };
            if (bmi < 35) return { name: 'Obese Class I', color: '#DC2626', risk: 'High' };
            if (bmi < 40) return { name: 'Obese Class II', color: '#DC2626', risk: 'Very High' };
            return { name: 'Obese Class III', color: '#DC2626', risk: 'Extremely High' };
        }
        
        // Standard adult BMI categories (WHO classification)
        if (bmi < 16.0) return { name: 'Severely Underweight', color: '#F59E0B', risk: 'Very High' };
        if (bmi < 18.5) return { name: 'Underweight', color: '#F59E0B', risk: 'Increased' };
        if (bmi < 25.0) return { name: 'Healthy Weight', color: '#059669', risk: 'Low' };
        if (bmi < 30.0) return { name: 'Overweight', color: '#D97706', risk: 'Increased' };
        if (bmi < 35.0) return { name: 'Obese Class I', color: '#DC2626', risk: 'High' };
        if (bmi < 40.0) return { name: 'Obese Class II', color: '#DC2626', risk: 'Very High' };
        return { name: 'Obese Class III', color: '#DC2626', risk: 'Extremely High' };
    }
    
    // Get Child BMI Percentile (CDC Growth Charts)
    // Reference: CDC Growth Charts (2000) - BMI-for-age percentiles
    // https://www.cdc.gov/growthcharts/
    function getChildBMIPercentile(bmi, age, gender) {
        // Note: This is a simplified estimation. Production version should use
        // CDC LMS parameters (Lambda, Mu, Sigma) for accurate percentile calculation
        // CDC provides separate growth charts for boys and girls ages 2-20
        
        // Simplified percentile estimation (for demonstration)
        // In production, implement LMS method: percentile = Œ¶((((value/M)^L) - 1) / (L*S))
        let estimatedPercentile;
        
        // Very rough approximation based on typical BMI distributions
        if (bmi < 14) estimatedPercentile = 2;
        else if (bmi < 15) estimatedPercentile = 5;
        else if (bmi < 16.5) estimatedPercentile = 15;
        else if (bmi < 18) estimatedPercentile = 50;
        else if (bmi < 20) estimatedPercentile = 75;
        else if (bmi < 22) estimatedPercentile = 85;
        else if (bmi < 25) estimatedPercentile = 95;
        else estimatedPercentile = 98;
        
        // CDC Categories for children/teens
        if (estimatedPercentile < 5) {
            return { 
                name: 'Underweight', 
                color: '#F59E0B', 
                percentile: estimatedPercentile,
                interpretation: 'Below 5th percentile'
            };
        }
        if (estimatedPercentile < 85) {
            return { 
                name: 'Healthy Weight', 
                color: '#059669', 
                percentile: estimatedPercentile,
                interpretation: '5th-84th percentile'
            };
        }
        if (estimatedPercentile < 95) {
            return { 
                name: 'Overweight', 
                color: '#D97706', 
                percentile: estimatedPercentile,
                interpretation: '85th-94th percentile'
            };
        }
        return { 
            name: 'Obese', 
            color: '#DC2626', 
            percentile: estimatedPercentile,
            interpretation: '95th percentile or above'
        };
    }
    
    // Estimate Body Fat Percentage using Deurenberg Formula
    // Reference: Deurenberg P, et al. (1991). Body mass index as a measure of body fatness
    // Int J Obes Relat Metab Disord. 15(2):97-105
    function estimateBodyFat(bmi, age, gender) {
        // Deurenberg formula: BF% = (1.20 √ó BMI) + (0.23 √ó Age) - (10.8 √ó Sex) - 5.4
        // Where Sex = 1 for males, 0 for females
        let bodyFat;
        if (gender === 'male') {
            bodyFat = (1.20 * bmi) + (0.23 * age) - (10.8 * 1) - 5.4;
        } else {
            bodyFat = (1.20 * bmi) + (0.23 * age) - (10.8 * 0) - 5.4;
        }
        
        // Clamp to realistic values
        return Math.max(3, Math.min(50, bodyFat));
    }
    
    // Calculate Ideal Weight Range
    function getIdealWeightRange(heightM, age, gender) {
        let minBMI = 18.5;
        let maxBMI = 24.9;
        
        // Adjust for seniors
        if (age >= 65) {
            minBMI = 23;
            maxBMI = 28;
        }
        
        const minWeight = minBMI * heightM * heightM;
        const maxWeight = maxBMI * heightM * heightM;
        
        return { minWeight, maxWeight, minBMI, maxBMI };
    }
    
    // Form Submit Handler
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const gender = genderInput.value;
        const age = parseInt(ageInput.value);
        let weightKg = parseFloat(weightInput.value);
        let heightM;
        
        // Convert weight to kg if needed
        if (currentWeightUnit === 'lbs') {
            weightKg = weightKg / 2.20462;
        }
        
        // Convert height to meters
        if (currentHeightUnit === 'imperial') {
            const feet = parseInt(heightFeet.value) || 0;
            const inches = parseFloat(heightInches.value) || 0;
            heightM = (feet * 0.3048) + (inches * 0.0254);
        } else {
            heightM = parseFloat(heightCm.value) / 100;
        }
        
        // Validation
        if (!gender || !age || !weightKg || !heightM) {
            alert('Please fill in all fields');
            return;
        }
        
        if (currentAgeType === 'child' && (age < 2 || age > 20)) {
            alert('For children, age must be between 2-20 years');
            return;
        }
        
        if (currentAgeType === 'adult' && age < 18) {
            alert('For adults, age must be 18 or older');
            return;
        }
        
        // Calculate BMI
        const bmi = calculateBMI(weightKg, heightM);
        
        // Get category
        let category;
        if (currentAgeType === 'child') {
            category = getChildBMIPercentile(bmi, age, gender);
        } else {
            category = getBMICategory(bmi, age, gender);
        }
        
        // Calculate additional metrics
        const bodyFat = estimateBodyFat(bmi, age, gender);
        const idealRange = getIdealWeightRange(heightM, age, gender);
        
        // Display results
        displayResults(bmi, category, bodyFat, idealRange, {
            gender,
            age,
            weightKg,
            heightM,
            ageType: currentAgeType
        });
    });
    
    // Display Results Function
    function displayResults(bmi, category, bodyFat, idealRange, userData) {
        const weightDisplay = currentWeightUnit === 'kg' 
            ? `${userData.weightKg.toFixed(1)} kg` 
            : `${(userData.weightKg * 2.20462).toFixed(1)} lbs`;
        
        const heightDisplay = currentHeightUnit === 'metric'
            ? `${(userData.heightM * 100).toFixed(1)} cm`
            : `${Math.floor(userData.heightM / 0.3048)}' ${Math.round((userData.heightM % 0.3048) / 0.0254)}"`;
        
        const idealMinWeight = currentWeightUnit === 'kg'
            ? `${idealRange.minWeight.toFixed(1)} kg`
            : `${(idealRange.minWeight * 2.20462).toFixed(1)} lbs`;
        
        const idealMaxWeight = currentWeightUnit === 'kg'
            ? `${idealRange.maxWeight.toFixed(1)} kg`
            : `${(idealRange.maxWeight * 2.20462).toFixed(1)} lbs`;
        
        // Calculate weight to lose/gain to reach healthy BMI
        let weightDiff = 0;
        let weightAction = '';
        if (bmi > idealRange.maxBMI) {
            weightDiff = (userData.weightKg - idealRange.maxWeight);
            weightAction = 'lose';
        } else if (bmi < idealRange.minBMI) {
            weightDiff = (idealRange.minWeight - userData.weightKg);
            weightAction = 'gain';
        }
        
        const weightDiffDisplay = currentWeightUnit === 'kg'
            ? `${Math.abs(weightDiff).toFixed(1)} kg`
            : `${(Math.abs(weightDiff) * 2.20462).toFixed(1)} lbs`;
        
        const resultsHTML = `
            <div class="bmi-results-header">
                <div class="bmi-results-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                    Your BMI Analysis
                </div>
            </div>
            
            <div class="bmi-main-results">
                <div class="bmi-result-item">
                    <span class="bmi-result-number">${bmi.toFixed(1)}</span>
                    <div class="bmi-result-label">Your BMI</div>
                </div>
                <div class="bmi-result-item">
                    <span class="bmi-result-number" style="color: ${category.color} !important;">${category.name}</span>
                    <div class="bmi-result-label">Category</div>
                </div>
            </div>
            
            <!-- Enhanced Slider-Style BMI Visualization -->
            <div class="bmi-slider-container">
                <div class="bmi-slider-result">
                    <div class="bmi-result-value">${bmi.toFixed(1)}</div>
                    <div class="bmi-result-category" style="color: ${category.color} !important;">${category.name}</div>
                </div>
                
                <div class="bmi-slider-track">
                    <!-- Background colored track -->
                    <div class="bmi-slider-segment bmi-underweight" style="width: 10.42% !important;"></div>
                    <div class="bmi-slider-segment bmi-healthy" style="width: 27.08% !important;"></div>
                    <div class="bmi-slider-segment bmi-overweight" style="width: 20.83% !important;"></div>
                    <div class="bmi-slider-segment bmi-obese" style="width: 41.67% !important;"></div>
                    
                    <!-- Labels below track -->
                    <div class="bmi-slider-labels">
                        <span style="left: 0% !important;">16</span>
                        <span style="left: 10.42% !important;">18.5</span>
                        <span style="left: 37.5% !important;">25</span>
                        <span style="left: 58.33% !important;">30</span>
                        <span style="left: 100% !important;">40</span>
                    </div>
                    
                    <!-- Animated indicator -->
                    <div class="bmi-slider-indicator" style="left: ${Math.min(100, Math.max(0, ((bmi - 16) / 24) * 100))}% !important;">
                        <div class="bmi-indicator-dot" style="background: ${category.color} !important;">
                            <div class="bmi-indicator-pulse" style="background: ${category.color} !important;"></div>
                        </div>
                        <div class="bmi-indicator-label" style="background: ${category.color} !important;">
                            ${bmi.toFixed(1)}
                        </div>
                    </div>
                </div>
                
                <!-- Classification Legend -->
                <div class="bmi-classification-box">
                    <h4 class="bmi-classification-title">BMI Classification (WHO)</h4>
                    <div class="bmi-classification-grid">
                        <div class="bmi-classification-item ${bmi < 18.5 ? 'active' : ''}">
                            <div class="bmi-class-dot" style="background: #F59E0B !important;"></div>
                            <span class="bmi-class-label">Underweight</span>
                            <span class="bmi-class-range">&lt;18.5</span>
                        </div>
                        <div class="bmi-classification-item ${bmi >= 18.5 && bmi < 25 ? 'active' : ''}">
                            <div class="bmi-class-dot" style="background: #059669 !important;"></div>
                            <span class="bmi-class-label">Normal weight</span>
                            <span class="bmi-class-range">18.5‚Äì24.9</span>
                        </div>
                        <div class="bmi-classification-item ${bmi >= 25 && bmi < 30 ? 'active' : ''}">
                            <div class="bmi-class-dot" style="background: #D97706 !important;"></div>
                            <span class="bmi-class-label">Overweight</span>
                            <span class="bmi-class-range">25‚Äì29.9</span>
                        </div>
                        <div class="bmi-classification-item ${bmi >= 30 ? 'active' : ''}">
                            <div class="bmi-class-dot" style="background: #DC2626 !important;"></div>
                            <span class="bmi-class-label">Obese</span>
                            <span class="bmi-class-range">‚â•30</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="bmi-action-buttons">
                <button class="bmi-action-btn bmi-save-btn" onclick="saveProgress()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    Save Progress
                </button>
                <button class="bmi-action-btn bmi-history-btn" onclick="toggleHistory()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    View History
                </button>
                <button class="bmi-action-btn bmi-print-btn" onclick="printResults()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 6 2 18 2 18 9"></polyline>
                        <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                        <rect x="6" y="14" width="12" height="8"></rect>
                    </svg>
                    Print
                </button>
                <button class="bmi-action-btn bmi-download-btn" onclick="downloadPDF()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download PDF
                </button>
                <button class="bmi-action-btn bmi-share-btn" onclick="shareResults()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="18" cy="5" r="3"></circle>
                        <circle cx="6" cy="12" r="3"></circle>
                        <circle cx="18" cy="19" r="3"></circle>
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                    </svg>
                    Share
                </button>
            </div>
            
            <!-- Progress History Section -->
            <div id="bmiHistorySection" class="bmi-history-container" style="display: none;">
                <div class="bmi-history-header">
                    <h3>üìä Your BMI Journey</h3>
                    <button class="bmi-close-history" onclick="toggleHistory()">‚úï</button>
                </div>
                
                <div class="bmi-history-stats">
                    <div class="bmi-stat-card">
                        <div class="bmi-stat-icon">üìà</div>
                        <div class="bmi-stat-label">Total Entries</div>
                        <div class="bmi-stat-value" id="totalEntries">0</div>
                    </div>
                    <div class="bmi-stat-card">
                        <div class="bmi-stat-icon">‚öñÔ∏è</div>
                        <div class="bmi-stat-label">Weight Change</div>
                        <div class="bmi-stat-value" id="weightChange">-</div>
                    </div>
                    <div class="bmi-stat-card">
                        <div class="bmi-stat-icon">üéØ</div>
                        <div class="bmi-stat-label">BMI Change</div>
                        <div class="bmi-stat-value" id="bmiChange">-</div>
                    </div>
                    <div class="bmi-stat-card">
                        <div class="bmi-stat-icon">üìÖ</div>
                        <div class="bmi-stat-label">Tracking Since</div>
                        <div class="bmi-stat-value" id="trackingSince">-</div>
                    </div>
                </div>

                <div class="bmi-chart-container">
                    <canvas id="bmiProgressChart"></canvas>
                </div>

                <div class="bmi-history-table">
                    <h4>üìã History Log</h4>
                    <div class="bmi-history-actions">
                        <button class="bmi-small-btn" onclick="exportHistory()">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Export CSV
                        </button>
                        <button class="bmi-small-btn bmi-danger-btn" onclick="clearHistory()">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                            Clear All
                        </button>
                    </div>
                    <div id="historyTableContent"></div>
                </div>
            </div>

            <!-- Goal Setting Section -->
            <div id="bmiGoalSection" class="bmi-goal-container">
                <div class="bmi-goal-header">
                    <h3>üéØ Set Your Goal</h3>
                    <p>Where do you want to be? Set a realistic goal and track your progress.</p>
                </div>

                <div class="bmi-goal-form">
                    <div class="bmi-goal-input-group">
                        <label>Goal Weight</label>
                        <div class="bmi-goal-input-row">
                            <input type="number" id="goalWeight" class="bmi-goal-input" placeholder="Enter goal weight" step="0.1" min="30" max="300" aria-label="Goal Weight">
                            <select id="goalWeightUnit" class="bmi-goal-select" onchange="convertGoalUnit()" aria-label="Goal Weight Unit">
                                <option value="kg">kg</option>
                                <option value="lbs">lbs</option>
                            </select>
                        </div>
                    </div>

                    <div class="bmi-goal-input-group">
                        <label>Weekly Goal</label>
                        <select id="weeklyGoal" class="bmi-goal-select">
                            <option value="0.25">Lose 0.25 kg (0.5 lbs) per week - Slow & Steady</option>
                            <option value="0.5" selected>Lose 0.5 kg (1 lb) per week - Moderate</option>
                            <option value="0.75">Lose 0.75 kg (1.5 lbs) per week - Aggressive</option>
                            <option value="1">Lose 1 kg (2 lbs) per week - Maximum Safe</option>
                            <option value="-0.25">Gain 0.25 kg (0.5 lbs) per week - Slow Bulk</option>
                            <option value="-0.5">Gain 0.5 kg (1 lb) per week - Moderate Bulk</option>
                        </select>
                    </div>

                    <button class="bmi-goal-calculate-btn" onclick="calculateGoal()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                        Calculate My Goal Plan
                    </button>
                </div>

                <div id="goalResults" class="bmi-goal-results" style="display: none;">
                    <div class="bmi-goal-summary">
                        <div class="bmi-goal-progress-ring">
                            <svg viewBox="0 0 200 200">
                                <circle cx="100" cy="100" r="85" fill="none" stroke="#E5E7EB" stroke-width="15"></circle>
                                <circle id="goalProgressCircle" cx="100" cy="100" r="85" fill="none" stroke="#1E40AF" stroke-width="15" stroke-linecap="round" 
                                        stroke-dasharray="534" stroke-dashoffset="534" transform="rotate(-90 100 100)"></circle>
                                <text x="100" y="90" text-anchor="middle" font-size="32" font-weight="bold" fill="#1E40AF" id="goalPercentText">0%</text>
                                <text x="100" y="120" text-anchor="middle" font-size="14" fill="#64748B">to goal</text>
                            </svg>
                        </div>
                        
                        <div class="bmi-goal-details">
                            <div class="bmi-goal-detail-item">
                                <span class="bmi-goal-label">Current Weight:</span>
                                <span class="bmi-goal-value" id="currentWeightDisplay">-</span>
                            </div>
                            <div class="bmi-goal-detail-item">
                                <span class="bmi-goal-label">Goal Weight:</span>
                                <span class="bmi-goal-value" id="goalWeightDisplay">-</span>
                            </div>
                            <div class="bmi-goal-detail-item">
                                <span class="bmi-goal-label">Weight to Lose/Gain:</span>
                                <span class="bmi-goal-value" id="weightDiffDisplay">-</span>
                            </div>
                            <div class="bmi-goal-detail-item">
                                <span class="bmi-goal-label">Estimated Time:</span>
                                <span class="bmi-goal-value highlight" id="timeToGoalDisplay">-</span>
                            </div>
                            <div class="bmi-goal-detail-item">
                                <span class="bmi-goal-label">Target Date:</span>
                                <span class="bmi-goal-value highlight" id="targetDateDisplay">-</span>
                            </div>
                            <div class="bmi-goal-detail-item">
                                <span class="bmi-goal-label">Daily Calorie Adjustment:</span>
                                <span class="bmi-goal-value highlight" id="calorieAdjustDisplay">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="bmi-milestone-section">
                        <h4>üéñÔ∏è Your Milestones</h4>
                        <div id="milestonesContainer" class="bmi-milestones-grid"></div>
                    </div>

                    <div class="bmi-goal-tips">
                        <h4>üí° Tips to Reach Your Goal</h4>
                        <div id="goalTipsContainer"></div>
                    </div>

                    <button class="bmi-save-goal-btn" onclick="saveGoal()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Save Goal & Track Progress
                    </button>
                </div>
            </div>
            
            <!-- Additional BMI Metrics -->
            <div class="bmi-metrics-grid">
                <div class="bmi-metric-card">
                    <div class="bmi-metric-icon">üìä</div>
                    <div class="bmi-metric-label">Healthy BMI Range</div>
                    <div class="bmi-metric-value">${idealRange.minBMI} - ${idealRange.maxBMI} kg/m¬≤</div>
                </div>
                <div class="bmi-metric-card">
                    <div class="bmi-metric-icon">‚öñÔ∏è</div>
                    <div class="bmi-metric-label">Healthy Weight Range</div>
                    <div class="bmi-metric-value">${currentWeightUnit === 'kg' ? idealRange.minWeight.toFixed(1) + ' - ' + idealRange.maxWeight.toFixed(1) + ' kg' : (idealRange.minWeight * 2.20462).toFixed(1) + ' - ' + (idealRange.maxWeight * 2.20462).toFixed(1) + ' lbs'}</div>
                </div>
                <div class="bmi-metric-card">
                    <div class="bmi-metric-icon">üéØ</div>
                    <div class="bmi-metric-label">BMI Prime</div>
                    <div class="bmi-metric-value">${(bmi / 25).toFixed(2)}</div>
                    <div class="bmi-metric-note">${bmi / 25 < 1 ? 'Below optimal' : bmi / 25 > 1 ? 'Above optimal' : 'Optimal'}</div>
                </div>
                <div class="bmi-metric-card">
                    <div class="bmi-metric-icon">üìê</div>
                    <div class="bmi-metric-label">Ponderal Index</div>
                    <div class="bmi-metric-value">${(userData.weightKg / Math.pow(userData.heightM, 3)).toFixed(1)} kg/m¬≥</div>
                    <div class="bmi-metric-note">Alternative to BMI</div>
                </div>
            </div>
            
            <div class="bmi-details-section">
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">Your Weight</span>
                    <span class="bmi-detail-value">${weightDisplay}</span>
                </div>
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">Your Height</span>
                    <span class="bmi-detail-value">${heightDisplay}</span>
                </div>
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">Age & Gender</span>
                    <span class="bmi-detail-value">${userData.age} years (${userData.gender})</span>
                </div>
                ${userData.ageType === 'adult' ? `
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">Estimated Body Fat</span>
                    <span class="bmi-detail-value">${bodyFat.toFixed(1)}%</span>
                </div>
                ` : `
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">BMI Percentile</span>
                    <span class="bmi-detail-value">${category.interpretation || 'See growth chart'}</span>
                </div>
                `}
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">Healthy Weight Range</span>
                    <span class="bmi-detail-value">${idealMinWeight} - ${idealMaxWeight}</span>
                </div>
                ${weightAction ? `
                <div class="bmi-detail-row">
                    <span class="bmi-detail-label">To Reach Healthy BMI</span>
                    <span class="bmi-detail-value">${weightAction === 'lose' ? 'Lose' : 'Gain'} ${weightDiffDisplay}</span>
                </div>
                ` : ''}
            </div>
            
            <!-- Tabs for additional info -->
            <div class="bmi-tabs">
                <button class="bmi-tab-btn active" data-tab="insights">Health Insights</button>
                <button class="bmi-tab-btn" data-tab="goals">Weight Goals</button>
                <button class="bmi-tab-btn" data-tab="composition">Body Composition</button>
                <button class="bmi-tab-btn" data-tab="recommendations">Recommendations</button>
            </div>
            
            <div class="bmi-tab-content active" data-tab-content="insights">
                ${getHealthInsights(bmi, category, userData)}
            </div>
            
            <div class="bmi-tab-content" data-tab-content="goals">
                ${getWeightGoals(userData, idealRange)}
            </div>
            
            <div class="bmi-tab-content" data-tab-content="composition">
                ${getBodyComposition(bodyFat, userData)}
            </div>
            
            <div class="bmi-tab-content" data-tab-content="recommendations">
                ${getRecommendations(category, userData)}
            </div>
        `;
        
        resultsContainer.innerHTML = resultsHTML;
        resultsContainer.classList.add('show');
        
        // Setup tab switching
        setupTabs();
        
        // Scroll to results
        resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
    
    // Print Results
    function printResults() {
        window.print();
    }

    // Download PDF using html2pdf library
    function downloadPDF() {
        // Check if html2pdf is available
        if (typeof html2pdf === 'undefined') {
            // Fallback: use print-to-PDF
            alert('To download as PDF, please use your browser\'s Print function and select "Save as PDF".\n\nOr we\'ll open the print dialog for you now.');
            window.print();
            return;
        }

        const resultsSection = document.getElementById('bmiResults');
        const opt = {
            margin: 10,
            filename: 'BMI-Analysis-Report.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };

        html2pdf().set(opt).from(resultsSection).save();
    }

    // Share Results
    function shareResults() {
        const resultsSection = document.getElementById('bmiResults');
        const bmiValue = resultsSection.querySelector('.bmi-result-value')?.textContent || 'N/A';
        const categoryValue = resultsSection.querySelector('.bmi-result-category')?.textContent || 'N/A';
        
        const shareText = `My BMI Analysis: ${bmiValue} (${categoryValue})\n\nCalculate yours at: ${window.location.href}`;
        
        // Check if Web Share API is available
        if (navigator.share) {
            navigator.share({
                title: 'My BMI Analysis',
                text: shareText,
                url: window.location.href
            }).then(() => {
                console.log('Shared successfully');
            }).catch((error) => {
                console.log('Error sharing:', error);
                fallbackShare(shareText);
            });
        } else {
            fallbackShare(shareText);
        }
    }

    // Fallback share function
    function fallbackShare(text) {
        const shareModal = document.createElement('div');
        shareModal.style.cssText = `
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            background: rgba(0, 0, 0, 0.7) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            z-index: 10000 !important;
        `;
        
        const modalContent = document.createElement('div');
        modalContent.style.cssText = `
            background: white !important;
            padding: 30px !important;
            border-radius: 12px !important;
            max-width: 500px !important;
            width: 90% !important;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3) !important;
        `;
        
        modalContent.innerHTML = `
            <h3 style="margin: 0 0 20px 0 !important; color: #1E40AF !important; font-size: 22px !important;">Share Your Results</h3>
            <div style="display: flex !important; gap: 15px !important; margin-bottom: 20px !important; flex-wrap: wrap !important; justify-content: center !important;">
                <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}" target="_blank" rel="noopener" style="display: inline-flex !important; align-items: center !important; gap: 8px !important; padding: 12px 20px !important; background: #1877F2 !important; color: white !important; text-decoration: none !important; border-radius: 8px !important; font-weight: 600 !important;">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                    Facebook
                </a>
                <a href="https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}" target="_blank" rel="noopener" style="display: inline-flex !important; align-items: center !important; gap: 8px !important; padding: 12px 20px !important; background: #1DA1F2 !important; color: white !important; text-decoration: none !important; border-radius: 8px !important; font-weight: 600 !important;">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg>
                    Twitter
                </a>
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(window.location.href)}" target="_blank" rel="noopener" style="display: inline-flex !important; align-items: center !important; gap: 8px !important; padding: 12px 20px !important; background: #0A66C2 !important; color: white !important; text-decoration: none !important; border-radius: 8px !important; font-weight: 600 !important;">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                    LinkedIn
                </a>
                <a href="https://wa.me/?text=${encodeURIComponent(text)}" target="_blank" rel="noopener" style="display: inline-flex !important; align-items: center !important; gap: 8px !important; padding: 12px 20px !important; background: #25D366 !important; color: white !important; text-decoration: none !important; border-radius: 8px !important; font-weight: 600 !important;">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                    WhatsApp
                </a>
            </div>
            <button onclick="this.closest('div').closest('div').remove()" style="width: 100% !important; padding: 12px !important; background: #E5E7EB !important; border: none !important; border-radius: 8px !important; font-weight: 600 !important; cursor: pointer !important; color: #374151 !important; font-size: 15px !important;">Close</button>
        `;
        
        shareModal.appendChild(modalContent);
        document.body.appendChild(shareModal);
        
        // Close on outside click
        shareModal.addEventListener('click', (e) => {
            if (e.target === shareModal) {
                shareModal.remove();
            }
        });
    }
    
    // Get Health Insights
    function getHealthInsights(bmi, category, userData) {
        let insights = '';
        
        // Special notice for children/teens
        if (userData.ageType === 'child') {
            insights += `
                <div class="bmi-info-box" style="background: #FEF3C7; border-color: #D97706;">
                    <div class="bmi-info-title" style="color: #92400E;">üìã Important for Children & Teens</div>
                    <div class="bmi-info-text" style="color: #92400E;">
                        <strong>This calculator uses simplified percentile estimation.</strong> For accurate assessment, consult:
                        <ul style="margin: 10px 0 0 20px;">
                            <li><a href="https://www.cdc.gov/growthcharts/data/extended-bmi/BMI-Age-percentiles-BOYS.pdf" target="_blank" rel="dofollow noopener" style="color: #92400E; text-decoration: underline;">CDC Growth Chart for Boys</a></li>
                            <li><a href="https://www.cdc.gov/growthcharts/data/extended-bmi/BMI-Age-percentiles-GIRLS.pdf" target="_blank" rel="dofollow noopener" style="color: #92400E; text-decoration: underline;">CDC Growth Chart for Girls</a></li>
                        </ul>
                        <br>
                        BMI for children must be interpreted using growth charts that account for age and gender. Always consult your pediatrician for proper assessment and guidance.
                    </div>
                </div>
            `;
        }
        
        if (category.name === 'Underweight') {
            insights = `
                <div class="bmi-info-box">
                    <div class="bmi-info-title">‚ö†Ô∏è Health Risk Assessment</div>
                    <div class="bmi-info-text">
                        Being underweight may increase risk of:
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Malnutrition and nutrient deficiencies</li>
                            <li>Weakened immune system</li>
                            <li>Osteoporosis and bone loss</li>
                            <li>Fertility issues</li>
                        </ul>
                    </div>
                </div>
            `;
        } else if (category.name === 'Healthy Weight') {
            insights = `
                <div class="bmi-info-box">
                    <div class="bmi-info-title">‚úÖ Great News!</div>
                    <div class="bmi-info-text">
                        Your BMI is in the healthy range. Maintaining this weight through balanced nutrition and regular exercise helps:
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Reduce disease risk</li>
                            <li>Maintain energy levels</li>
                            <li>Support overall wellness</li>
                            <li>Promote longevity</li>
                        </ul>
                    </div>
                </div>
            `;
        } else if (category.name === 'Overweight' || category.name.includes('Obese')) {
            insights = `
                <div class="bmi-info-box">
                    <div class="bmi-info-title">‚ö†Ô∏è Health Risk Assessment</div>
                    <div class="bmi-info-text">
                        Elevated BMI may increase risk of:
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Type 2 diabetes</li>
                            <li>Heart disease and high blood pressure</li>
                            <li>Sleep apnea</li>
                            <li>Joint problems</li>
                            <li>Certain cancers</li>
                        </ul>
                        <br>
                        <strong>Good news:</strong> Even modest weight loss (5-10%) can significantly improve health markers.
                    </div>
                </div>
            `;
        }
        
        // Add BMI limitation note
        insights += `
            <div class="bmi-info-box" style="background: #FEF3C7; border-color: #D97706;">
                <div class="bmi-info-title" style="color: #92400E;">üìä Important: BMI Limitations</div>
                <div class="bmi-info-text" style="color: #92400E;">
                    BMI doesn't account for muscle mass, bone density, or body composition. Athletes and muscular individuals may have high BMI despite low body fat. Consider additional metrics like waist circumference and body fat percentage for complete assessment.
                </div>
            </div>
        `;
        
        return insights;
    }
    
    // Get Weight Goals
    function getWeightGoals(userData, idealRange) {
        const currentWeightLbs = userData.weightKg * 2.20462;
        const currentWeightKg = userData.weightKg;
        
        const goals = [
            {
                title: 'Extreme Weight Loss',
                targetWeightKg: userData.weightKg * 0.85,
                weeklyLoss: 2,
                note: '‚ö†Ô∏è Aggressive - Medical supervision recommended'
            },
            {
                title: 'Moderate Weight Loss',
                targetWeightKg: userData.weightKg * 0.90,
                weeklyLoss: 1.5,
                note: 'Sustainable for most people'
            },
            {
                title: 'Gradual Weight Loss',
                targetWeightKg: userData.weightKg * 0.95,
                weeklyLoss: 1,
                note: '‚úì Recommended - Most sustainable'
            },
            {
                title: 'Maintain Current Weight',
                targetWeightKg: userData.weightKg,
                weeklyLoss: 0,
                note: 'Focus on body composition'
            },
            {
                title: 'Healthy BMI Range',
                targetWeightKg: (idealRange.minWeight + idealRange.maxWeight) / 2,
                weeklyLoss: 1,
                note: 'Optimal health target'
            }
        ];
        
        let goalsHTML = '<div class="bmi-goals-grid">';
        
        goals.forEach(goal => {
            const targetDisplay = currentWeightUnit === 'kg'
                ? `${goal.targetWeightKg.toFixed(1)} kg`
                : `${(goal.targetWeightKg * 2.20462).toFixed(1)} lbs`;
            
            const diff = Math.abs(userData.weightKg - goal.targetWeightKg);
            const weeks = goal.weeklyLoss > 0 ? Math.ceil((diff * 2.20462) / goal.weeklyLoss) : 0;
            
            goalsHTML += `
                <div class="bmi-goal-card">
                    <div class="bmi-goal-title">${goal.title}</div>
                    <div class="bmi-goal-value">${targetDisplay}</div>
                    <div class="bmi-goal-subtitle">${weeks > 0 ? `~${weeks} weeks` : goal.note}</div>
                    <div class="bmi-goal-subtitle" style="margin-top: 5px; font-size: 12px;">${goal.note}</div>
                </div>
            `;
        });
        
        goalsHTML += '</div>';
        
        goalsHTML += `
            <div class="bmi-info-box" style="margin-top: 20px;">
                <div class="bmi-info-title">üéØ Setting Realistic Goals</div>
                <div class="bmi-info-text">
                    <strong>Safe Weight Loss Rate:</strong> 0.5-2 lbs (0.25-1 kg) per week<br>
                    <strong>Calorie Deficit Needed:</strong> 500-1000 cal/day for 1-2 lbs/week loss<br><br>
                    Rapid weight loss can lead to muscle loss, nutritional deficiencies, and gallstones. Gradual change is more sustainable and healthier.
                </div>
            </div>
        `;
        
        return goalsHTML;
    }
    
    // Get Body Composition
    function getBodyComposition(bodyFat, userData) {
        // Healthy body fat ranges
        let healthyRange = '';
        if (userData.gender === 'male') {
            if (userData.age < 30) healthyRange = '14-20%';
            else if (userData.age < 50) healthyRange = '18-24%';
            else healthyRange = '19-25%';
        } else {
            if (userData.age < 30) healthyRange = '21-27%';
            else if (userData.age < 50) healthyRange = '25-31%';
            else healthyRange = '27-33%';
        }
        
        // Estimate lean body mass
        const fatMassKg = userData.weightKg * (bodyFat / 100);
        const leanMassKg = userData.weightKg - fatMassKg;
        
        const fatMassDisplay = currentWeightUnit === 'kg'
            ? `${fatMassKg.toFixed(1)} kg`
            : `${(fatMassKg * 2.20462).toFixed(1)} lbs`;
        
        const leanMassDisplay = currentWeightUnit === 'kg'
            ? `${leanMassKg.toFixed(1)} kg`
            : `${(leanMassKg * 2.20462).toFixed(1)} lbs`;
        
        return `
            <div class="bmi-info-box">
                <div class="bmi-info-title">üìä Estimated Body Composition</div>
                <div class="bmi-info-text">
                    <strong>Estimated Body Fat:</strong> ${bodyFat.toFixed(1)}%<br>
                    <strong>Healthy Range for Your Age/Gender:</strong> ${healthyRange}<br>
                    <strong>Estimated Fat Mass:</strong> ${fatMassDisplay}<br>
                    <strong>Estimated Lean Mass:</strong> ${leanMassDisplay}<br><br>
                    
                    <em>Note: This is an estimate using the Deurenberg formula. For accurate body fat measurement, consider DEXA scan, bioelectrical impedance, or skinfold calipers.</em>
                </div>
            </div>
            
            <div class="bmi-info-box">
                <div class="bmi-info-title">üí™ Body Fat Categories</div>
                <div class="bmi-info-text">
                    <strong>Essential Fat:</strong> 2-5% (men), 10-13% (women)<br>
                    <strong>Athletes:</strong> 6-13% (men), 14-20% (women)<br>
                    <strong>Fitness:</strong> 14-17% (men), 21-24% (women)<br>
                    <strong>Average:</strong> 18-24% (men), 25-31% (women)<br>
                    <strong>Above Average:</strong> 25-30% (men), 32-38% (women)<br>
                    <strong>Obese:</strong> 30%+ (men), 38%+ (women)
                </div>
            </div>
            
            <div class="bmi-info-box">
                <div class="bmi-info-title">üìê Other Useful Metrics</div>
                <div class="bmi-info-text">
                    Consider measuring:<br>
                    ‚Ä¢ <a href="https://fitliferegime.com/body-fat-percentage-calculator-based-on-caliper-and-us-navy/" target="_blank" rel="dofollow noopener" style="color: #1E40AF; font-weight: 600;">Body Fat Percentage Calculator</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/waist-to-hip-ratio-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF; font-weight: 600;">Waist-to-Hip Ratio</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/lean-body-mass-calculator-equation/" target="_blank" rel="dofollow noopener" style="color: #1E40AF; font-weight: 600;">Lean Body Mass</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/ffmi-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF; font-weight: 600;">FFMI (Fat-Free Mass Index)</a>
                </div>
            </div>
        `;
    }
    
    // Get Recommendations
    function getRecommendations(category, userData) {
        let recommendations = `
            <div class="bmi-info-box">
                <div class="bmi-info-title">üèãÔ∏è Exercise Recommendations</div>
                <div class="bmi-info-text">
                    <strong>Cardio:</strong> 150-300 minutes of moderate-intensity or 75-150 minutes vigorous-intensity per week<br>
                    <strong>Strength Training:</strong> 2-3 days per week, all major muscle groups<br>
                    <strong>Flexibility:</strong> Daily stretching and mobility work<br><br>
                    
                    <strong>Suggested Workouts:</strong><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/15-best-leg-exercises-and-workout-for-strength/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Leg Strengthening Exercises</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/10-easy-core-strengthening-exercises-for-beginners/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Core Strengthening</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/bodyweight-workout/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Bodyweight Workouts</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/hiit-workout-plan/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">HIIT Training Plans</a>
                </div>
            </div>
            
            <div class="bmi-info-box">
                <div class="bmi-info-title">ü•ó Nutrition Recommendations</div>
                <div class="bmi-info-text">
                    <strong>Calculate Your Needs:</strong><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/tdee-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">TDEE Calculator</a> - Daily calorie needs<br>
                    ‚Ä¢ <a href="https://fitliferegime.com/macro-calculator-with-meal-plans/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Macro Calculator</a> - Protein, carbs, fats<br>
                    ‚Ä¢ <a href="https://fitliferegime.com/protein-intake-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Protein Calculator</a> - Optimal protein intake<br><br>
                    
                    <strong>General Guidelines:</strong><br>
                    ‚Ä¢ Focus on whole, unprocessed foods<br>
                    ‚Ä¢ Include lean protein with each meal<br>
                    ‚Ä¢ Eat plenty of vegetables and fruits<br>
                    ‚Ä¢ Stay hydrated (use our <a href="https://fitliferegime.com/daily-water-intake-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Water Intake Calculator</a>)<br>
                    ‚Ä¢ Limit added sugars and saturated fats
                </div>
            </div>
            
            <div class="bmi-info-box">
                <div class="bmi-info-title">üìä Track Your Progress</div>
                <div class="bmi-info-text">
                    <strong>Recommended Tracking:</strong><br>
                    ‚Ä¢ Weekly weigh-ins (same day/time)<br>
                    ‚Ä¢ Monthly body measurements<br>
                    ‚Ä¢ Progress photos every 4 weeks<br>
                    ‚Ä¢ How clothes fit<br>
                    ‚Ä¢ Energy levels and mood<br><br>
                    
                    <strong>Related Calculators:</strong><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/weight-loss-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Weight Loss Calculator</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/weight-gain-calorie-calculator/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Weight Gain Calculator</a><br>
                    ‚Ä¢ <a href="https://fitliferegime.com/body-fat-percentage-calculator-based-on-caliper-and-us-navy/" target="_blank" rel="dofollow noopener" style="color: #1E40AF;">Body Fat Calculator</a>
                </div>
            </div>
            
            <div class="bmi-info-box" style="background: #FEF3C7; border-color: #D97706;">
                <div class="bmi-info-title" style="color: #92400E;">‚öïÔ∏è Medical Disclaimer</div>
                <div class="bmi-info-text" style="color: #92400E;">
                    This calculator provides estimates for educational purposes only and should not replace professional medical advice. 
                    Consult with healthcare providers before starting any weight loss program, especially if you have pre-existing health conditions. 
                    BMI is a screening tool and doesn't directly measure body fat or health status.
                </div>
            </div>
        `;
        
        return recommendations;
    }
    
    // Setup Tab Switching
    function setupTabs() {
        const tabButtons = document.querySelectorAll('.bmi-tab-btn');
        const tabContents = document.querySelectorAll('.bmi-tab-content');
        
        tabButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                
                // Remove active class from all
                tabButtons.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab
                this.classList.add('active');
                const targetContent = document.querySelector(`[data-tab-content="${tabName}"]`);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
            });
        });
    }
})();
</script>

    <!-- SEO Content Section -->
    <div class="sf-calculator-wrapper">
        <div class="sf-seo-wrapper">
            <!-- What is BMI -->
            <div class="sf-seo-section">
            <h2 class="sf-section-heading">What is BMI (Body Mass Index)?</h2>
            <div class="sf-content-card">
                <p>
                    BMI stands for <strong>Body Mass Index</strong>, a widely used screening tool that measures body fat based on your weight and height. 
                    Developed by Belgian mathematician Adolphe Quetelet in the 1830s, BMI provides a simple numeric measure to classify individuals into weight categories.
                </p>
                <br>
                <p>
                    The BMI calculation divides a person's weight in kilograms by the square of their height in meters. This resulting number helps identify potential 
                    health risks associated with being underweight, overweight, or obese.
                </p>
                <br>
                <p>
                    According to the <a href="https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html" target="_blank" rel="dofollow noopener">Centers for Disease Control (CDC)</a>, 
                    BMI is an effective screening tool for identifying weight-related health risks. However, it's important to note that BMI doesn't directly measure 
                    <a href="https://fitliferegime.com/visual-body-fat-percentage/" target="_blank" rel="dofollow noopener">body fat percentage</a> or account for muscle mass, 
                    bone density, or overall body composition.
                </p>
                <br>
                <p>
                    For a complete health assessment, BMI should be combined with other measurements like waist circumference, <a href="https://fitliferegime.com/waist-to-hip-ratio-calculator/" target="_blank" rel="dofollow noopener">waist-to-hip ratio</a>, 
                    and <a href="https://fitliferegime.com/body-fat-percentage-calculator-based-on-caliper-and-us-navy/" target="_blank" rel="dofollow noopener">body fat percentage</a> for more accurate health evaluation.
                </p>
            </div>

            <!-- BMI Calculator Image -->
            <div class="sf-image-container">
                <img src="http://fitliferegime.com/wp-content/uploads/2023/04/BMI-Calculator.jpg" alt="BMI Calculator" class="sf-content-image">
            </div>
        </div>

        <!-- How to Calculate BMI -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">How to Calculate BMI</h2>
            
            <div class="sf-formula-container">
                <!-- Metric Formula -->
                <div class="sf-formula-card">
                    <div class="sf-formula-header">BMI Formula (Metric Units)</div>
                    <div class="sf-formula-body">
                        <div class="sf-formula-item">
                            <div class="sf-formula-label">Formula:</div>
                            <div class="sf-formula-text">BMI = Weight (kg) √∑ Height¬≤ (m¬≤)</div>
                        </div>
                        
                        <div class="sf-formula-item">
                            <div class="sf-formula-label">Example Calculation:</div>
                            <div class="sf-formula-text">
                                Weight: 70 kg, Height: 1.75 m<br>
                                BMI = 70 √∑ (1.75 √ó 1.75)<br>
                                BMI = 70 √∑ 3.0625<br>
                                BMI = 22.86
                            </div>
                            <div class="sf-formula-note">‚úì Result: 22.86 BMI (Healthy Weight)</div>
                        </div>
                    </div>
                </div>

                <!-- Imperial Formula -->
                <div class="sf-formula-card">
                    <div class="sf-formula-header">BMI Formula (Imperial Units)</div>
                    <div class="sf-formula-body">
                        <div class="sf-formula-item">
                            <div class="sf-formula-label">Formula:</div>
                            <div class="sf-formula-text">BMI = (Weight (lbs) √∑ Height¬≤ (inches)) √ó 703</div>
                        </div>
                        
                        <div class="sf-formula-item">
                            <div class="sf-formula-label">Example Calculation:</div>
                            <div class="sf-formula-text">
                                Weight: 150 lbs, Height: 65 inches<br>
                                BMI = (150 √∑ (65 √ó 65)) √ó 703<br>
                                BMI = (150 √∑ 4225) √ó 703<br>
                                BMI = 24.96
                            </div>
                            <div class="sf-formula-note">‚úì Result: 24.96 BMI (Healthy Weight)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- How to Calculate BMI Image -->
            <div class="sf-image-container">
                <img src="http://fitliferegime.com/wp-content/uploads/2023/04/How-To-Calculate-Body-Mass-Index-BMI.jpg" alt="How To Calculate Body Mass Index, BMI" class="sf-content-image">
            </div>
        </div>

        <!-- BMI Classification -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">BMI Classification & Categories</h2>
            
            <div class="sf-content-card">
                <p>
                    The World Health Organization (WHO) and CDC use standardized BMI categories to assess health risks. These classifications are based on extensive research 
                    linking BMI values to disease risk and mortality rates (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/" target="_blank" rel="dofollow noopener">Nuttall, 2015</a>).
                </p>
            </div>

            <div class="sf-table-wrapper">
                <table class="sf-standards-table">
                    <thead>
                        <tr>
                            <th>BMI Range</th>
                            <th>Classification</th>
                            <th>Disease Risk</th>
                            <th>Health Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt; 16.0</td>
                            <td>Severely Underweight</td>
                            <td>Very High</td>
                            <td>Malnutrition risk</td>
                        </tr>
                        <tr>
                            <td>16.0 - 18.4</td>
                            <td>Underweight</td>
                            <td>Increased</td>
                            <td>Below healthy range</td>
                        </tr>
                        <tr style="background: rgba(5, 150, 105, 0.1);">
                            <td><strong>18.5 - 24.9</strong></td>
                            <td><strong>Healthy Weight</strong></td>
                            <td><strong>Low</strong></td>
                            <td><strong>Optimal range</strong></td>
                        </tr>
                        <tr>
                            <td>25.0 - 29.9</td>
                            <td>Overweight</td>
                            <td>Increased</td>
                            <td>Above healthy range</td>
                        </tr>
                        <tr>
                            <td>30.0 - 34.9</td>
                            <td>Obese Class I</td>
                            <td>High</td>
                            <td>Obesity treatment advised</td>
                        </tr>
                        <tr>
                            <td>35.0 - 39.9</td>
                            <td>Obese Class II</td>
                            <td>Very High</td>
                            <td>Medical intervention needed</td>
                        </tr>
                        <tr>
                            <td>‚â• 40.0</td>
                            <td>Obese Class III</td>
                            <td>Extremely High</td>
                            <td>Severe obesity</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="sf-standards-note">
                <strong>Note:</strong> For adults 65 and older, research suggests a slightly higher BMI range (23-28) may be associated with better health outcomes 
                (<a href="https://academic.oup.com/ajcn/article/99/4/875/4637859" target="_blank" rel="dofollow noopener">Winter et al., 2014</a>).
            </div>

            <!-- BMI Categories Image -->
            <div class="sf-image-container">
                <img src="http://fitliferegime.com/wp-content/uploads/2023/04/BMI-Categories.jpg" alt="BMI Categories" class="sf-content-image">
            </div>
        </div>

        <!-- Additional Metrics -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">Understanding Additional Metrics</h2>
            
            <div class="sf-content-grid">
                <div class="sf-content-card">
                    <h3>BMI Prime</h3>
                    <p>
                        <strong>BMI Prime</strong> is calculated by dividing your BMI by 25 (the upper limit of healthy BMI). A BMI Prime of 1.0 indicates optimal weight, 
                        while values below 1.0 suggest underweight and above 1.0 indicate overweight.
                    </p>
                    <br>
                    <p>
                        <strong>Formula:</strong> BMI Prime = Your BMI √∑ 25
                    </p>
                    <br>
                    <p>
                        This metric provides a simple way to see how far you are from the ideal BMI threshold and is particularly useful for tracking progress over time.
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>Ponderal Index</h3>
                    <p>
                        The <strong>Ponderal Index (PI)</strong>, also known as Rohrer's Index, is an alternative measure that uses height cubed instead of squared. 
                        This makes it more accurate for very tall or short individuals where standard BMI may be misleading.
                    </p>
                    <br>
                    <p>
                        <strong>Formula:</strong> PI = Weight (kg) √∑ Height¬≥ (m¬≥)
                    </p>
                    <br>
                    <p>
                        Normal range for adults is 11-14 kg/m¬≥. The Ponderal Index is particularly useful in pediatric medicine and for individuals at height extremes.
                    </p>
                </div>
            </div>
        </div>

        <!-- BMI for Different Groups -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">BMI for Special Populations</h2>
            
            <div class="sf-content-grid">
                <div class="sf-content-card">
                    <h3>BMI for Children & Teens (Ages 2-20)</h3>
                    <p>
                        For children and teenagers, BMI is calculated the same way but interpreted differently using <strong>growth charts and percentiles</strong> that account for age and gender. 
                        The CDC provides specific BMI-for-age percentile charts:
                    </p>
                    <br>
                    <p>
                        ‚Ä¢ <strong>Underweight:</strong> Below 5th percentile<br>
                        ‚Ä¢ <strong>Healthy Weight:</strong> 5th to 84th percentile<br>
                        ‚Ä¢ <strong>Overweight:</strong> 85th to 94th percentile<br>
                        ‚Ä¢ <strong>Obese:</strong> 95th percentile or above
                    </p>
                    <br>
                    <p>
                        Always consult your pediatrician for proper interpretation. View official charts: 
                        <a href="https://www.cdc.gov/growthcharts/data/extended-bmi/BMI-Age-percentiles-BOYS.pdf" target="_blank" rel="dofollow noopener">CDC Growth Chart for Boys</a> | 
                        <a href="https://www.cdc.gov/growthcharts/data/extended-bmi/BMI-Age-percentiles-GIRLS.pdf" target="_blank" rel="dofollow noopener">CDC Growth Chart for Girls</a>
                    </p>
                    
                    <!-- BMI Chart Image -->
                    <div class="sf-image-container" style="margin-top: 20px;">
                        <img src="http://fitliferegime.com/wp-content/uploads/2023/04/BMI-chart.jpg" alt="BMI Chart" class="sf-content-image">
                    </div>
                </div>

                <div class="sf-content-card">
                    <h3>BMI for Athletes & Bodybuilders</h3>
                    <p>
                        BMI has significant limitations for athletes and individuals with high muscle mass. Since muscle weighs more than fat, athletic individuals may be classified as "overweight" or even "obese" despite having low body fat.
                    </p>
                    <br>
                    <p>
                        For athletes, consider alternative measurements:
                    </p>
                    <br>
                    <p>
                        ‚Ä¢ <a href="https://fitliferegime.com/body-fat-percentage-calculator-based-on-caliper-and-us-navy/" target="_blank" rel="dofollow noopener">Body Fat Percentage</a> (more accurate)<br>
                        ‚Ä¢ <a href="https://fitliferegime.com/ffmi-calculator/" target="_blank" rel="dofollow noopener">Fat-Free Mass Index (FFMI)</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/waist-to-hip-ratio-calculator/" target="_blank" rel="dofollow noopener">Waist-to-Hip Ratio</a><br>
                        ‚Ä¢ Skinfold measurements or DEXA scans
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>BMI for Seniors (65+)</h3>
                    <p>
                        Research shows that slightly higher BMI may be healthier for older adults. The optimal BMI range for seniors (65+) is typically <strong>23-28</strong>, 
                        rather than the standard 18.5-24.9.
                    </p>
                    <br>
                    <p>
                        This is because older adults experience natural changes in body composition, including decreased muscle mass and bone density. 
                        A study published in the American Journal of Clinical Nutrition found that BMI between 23-28 was associated with lower mortality in older adults 
                        (<a href="https://academic.oup.com/ajcn/article/99/4/875/4637859" target="_blank" rel="dofollow noopener">Winter et al., 2014</a>).
                    </p>
                </div>
            </div>
        </div>

        <!-- Health Risks -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">Health Risks of High BMI (Overweight/Obesity)</h2>
            
            <div class="sf-content-card">
                <p>
                    Being overweight or obese (BMI ‚â• 25) significantly increases the risk of numerous health conditions. Research from the 
                    <a href="https://www.hsph.harvard.edu/obesity-prevention-source/obesity-consequences/health-effects/" target="_blank" rel="dofollow noopener">Harvard School of Public Health</a> 
                    shows that as BMI increases, so does the risk of developing:
                </p>
            </div>

            <div class="sf-content-grid">
                <div class="sf-content-card">
                    <h3>Cardiovascular Risks</h3>
                    <p>
                        ‚Ä¢ <strong>Heart Disease:</strong> 2-3√ó increased risk<br>
                        ‚Ä¢ <strong>High Blood Pressure:</strong> 2-6√ó increased risk<br>
                        ‚Ä¢ <strong>Stroke:</strong> Elevated blood clot formation<br>
                        ‚Ä¢ <strong>High Cholesterol:</strong> Plaque buildup in arteries
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>Metabolic Disorders</h3>
                    <p>
                        ‚Ä¢ <strong>Type 2 Diabetes:</strong> 20-40√ó risk at BMI 30+ (<a href="https://myhealthywaist.org/documentation-centre/long-term-effects-of-a-lifestyle-intervention-on-weight-and-cardiovascular-risk-factors-in-individuals-with-type-2-diabetes-mellitus-four-year-results-of-the-look-ahead-trial/" target="_blank" rel="dofollow noopener">Look AHEAD Trial</a>)<br>
                        ‚Ä¢ <strong>Metabolic Syndrome:</strong> Cluster of risk factors<br>
                        ‚Ä¢ <strong>Fatty Liver Disease:</strong> Fat accumulation in liver<br>
                        ‚Ä¢ <strong>Gallbladder Disease:</strong> Increased gallstone risk
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>Other Health Concerns</h3>
                    <p>
                        ‚Ä¢ <strong>Sleep Apnea:</strong> 10-30√ó risk at BMI 30+ (<a href="https://www.mdpi.com/2077-0383/10/7/1485/htm" target="_blank" rel="dofollow noopener">Research Study</a>)<br>
                        ‚Ä¢ <strong>Joint Pain & Arthritis:</strong> 4-5√ó risk (<a href="https://www.hopkinsarthritis.org/patient-corner/disease-management/role-of-body-weight-in-osteoarthritis/" target="_blank" rel="dofollow noopener">Hopkins Arthritis</a>)<br>
                        ‚Ä¢ <strong>Certain Cancers:</strong> 1.5-2√ó risk<br>
                        ‚Ä¢ <strong>Respiratory Issues:</strong> Asthma, breathing difficulties<br>
                        ‚Ä¢ <strong>Reproductive Problems:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/19261274/" target="_blank" rel="dofollow noopener">Infertility, PCOS</a>
                    </p>
                </div>
            </div>

            <div class="sf-standards-note">
                <strong>Good News:</strong> Even modest weight loss (5-10% of body weight) can significantly reduce these health risks. 
                Learn more about <a href="https://fitliferegime.com/best-ways-to-lose-weight/" target="_blank" rel="dofollow noopener">safe weight loss strategies</a>.
            </div>

            <!-- Health Risks Image -->
            <div class="sf-image-container">
                <img src="http://fitliferegime.com/wp-content/uploads/2023/04/Health-Risks-Related-To-Being-Overweight.png" alt="Health Risks Related To Being Overweight" class="sf-content-image">
            </div>
        </div>

        <!-- Underweight Risks -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">Health Risks of Low BMI (Underweight)</h2>
            
            <div class="sf-content-card">
                <p>
                    Being underweight (BMI &lt; 18.5) can be just as concerning as being overweight. Low BMI may indicate malnutrition and is associated with several health risks:
                </p>
            </div>

            <div class="sf-content-grid">
                <div class="sf-content-card">
                    <h3>Nutritional Deficiencies</h3>
                    <p>
                        ‚Ä¢ Protein, vitamin, and mineral deficiencies<br>
                        ‚Ä¢ Weakened immune system<br>
                        ‚Ä¢ Anemia (low iron)<br>
                        ‚Ä¢ Poor wound healing
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>Physical Health Issues</h3>
                    <p>
                        ‚Ä¢ <a href="https://www.mayoclinic.org/diseases-conditions/osteoporosis/symptoms-causes/syc-20351968" target="_blank" rel="dofollow noopener">Osteoporosis</a> and bone loss<br>
                        ‚Ä¢ Muscle weakness and atrophy<br>
                        ‚Ä¢ Fertility problems and irregular periods<br>
                        ‚Ä¢ <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7797319/" target="_blank" rel="dofollow noopener">Impaired growth</a> (children/teens)
                    </p>
                </div>
            </div>

            <div class="sf-standards-note">
                <strong>If you're underweight:</strong> Consult a healthcare provider or registered dietitian to develop a healthy weight gain plan. 
                Explore <a href="https://fitliferegime.com/weight-gain-calorie-calculator/" target="_blank" rel="dofollow noopener">calorie needs for weight gain</a> and 
                <a href="https://fitliferegime.com/high-protein-sources-vegetarian/" target="_blank" rel="dofollow noopener">high-protein nutrition</a>.
            </div>
        </div>

        <!-- Limitations of BMI -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">Limitations of BMI</h2>
            
            <div class="sf-content-card">
                <p>
                    While BMI is a useful screening tool, it has important limitations that should be understood 
                    (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/" target="_blank" rel="dofollow noopener">Nuttall, 2015</a>):
                </p>
            </div>

            <div class="sf-content-grid">
                <div class="sf-content-card">
                    <h3>‚ùå Doesn't Measure Body Composition</h3>
                    <p>
                        BMI cannot distinguish between muscle, fat, bone, and water weight. A muscular athlete may have a high BMI despite low body fat, 
                        while someone with low muscle mass may have a "healthy" BMI but high body fat percentage (sarcopenic obesity).
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>‚ùå Ignores Fat Distribution</h3>
                    <p>
                        BMI doesn't account for where fat is stored. Visceral fat (around organs) is more dangerous than subcutaneous fat (under skin). 
                        Two people with the same BMI may have very different health risks based on fat distribution.
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>‚ùå Age & Gender Differences</h3>
                    <p>
                        BMI uses the same thresholds for all adults, but healthy body composition varies by age and gender. Women naturally have higher body fat percentages, 
                        and older adults may need slightly higher BMIs for optimal health.
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>‚ùå Ethnicity Variations</h3>
                    <p>
                        Different ethnic groups may have different body compositions at the same BMI. For example, Asian populations tend to have higher body fat percentages 
                        at lower BMIs, leading the WHO to recommend lower cutoffs (23 for overweight, 27.5 for obesity) for Asian populations.
                    </p>
                </div>
            </div>

            <div class="sf-standards-note">
                <strong>Bottom Line:</strong> Use BMI as one part of your health assessment, not the only measure. Combine it with waist circumference, 
                <a href="https://fitliferegime.com/body-fat-percentage-calculator-based-on-caliper-and-us-navy/" target="_blank" rel="dofollow noopener">body fat percentage</a>, 
                fitness level, and overall health markers for a complete picture.
            </div>
        </div>

        <!-- Related Tools -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">Related Health & Fitness Calculators</h2>
            
            <div class="sf-content-grid">
                <div class="sf-content-card">
                    <h3>Body Composition Tools</h3>
                    <p>
                        ‚Ä¢ <a href="https://fitliferegime.com/body-fat-percentage-calculator-based-on-caliper-and-us-navy/" target="_blank" rel="dofollow noopener">Body Fat Percentage Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/ffmi-calculator/" target="_blank" rel="dofollow noopener">Fat-Free Mass Index (FFMI)</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/lean-body-mass-calculator-equation/" target="_blank" rel="dofollow noopener">Lean Body Mass Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/waist-to-hip-ratio-calculator/" target="_blank" rel="dofollow noopener">Waist-to-Hip Ratio</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/ideal-weight-calculator/" target="_blank" rel="dofollow noopener">Ideal Weight Calculator</a>
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>Calorie & Nutrition Tools</h3>
                    <p>
                        ‚Ä¢ <a href="https://fitliferegime.com/tdee-calculator/" target="_blank" rel="dofollow noopener">TDEE Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/bmr-basal-metabolic-rate-calculator/" target="_blank" rel="dofollow noopener">BMR Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/macro-calculator-with-meal-plans/" target="_blank" rel="dofollow noopener">Macro Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/weight-loss-calorie-calculator/" target="_blank" rel="dofollow noopener">Weight Loss Calorie Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/protein-intake-calculator/" target="_blank" rel="dofollow noopener">Protein Intake Calculator</a>
                    </p>
                </div>

                <div class="sf-content-card">
                    <h3>Fitness & Performance Tools</h3>
                    <p>
                        ‚Ä¢ <a href="https://fitliferegime.com/one-rep-max-calculator/" target="_blank" rel="dofollow noopener">One Rep Max Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/vo2-max-calculator-aerobic-capacity/" target="_blank" rel="dofollow noopener">VO‚ÇÇ Max Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/workout-plan-generator/" target="_blank" rel="dofollow noopener">Workout Plan Generator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/exercise-calories-burned-calculator/" target="_blank" rel="dofollow noopener">Calories Burned Calculator</a><br>
                        ‚Ä¢ <a href="https://fitliferegime.com/walking-calorie-burn-calculator/" target="_blank" rel="dofollow noopener">Walking Calorie Calculator</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Scientific References -->
        <div class="sf-seo-section">
            <h2 class="sf-section-heading">Scientific References & Research</h2>
            
            <div class="sf-research-container">
                <div class="sf-research-card">
                    <div class="sf-research-number">1</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/" target="_blank" rel="dofollow noopener">
                                Body Mass Index: Obesity, BMI, and Health: A Critical Review
                            </a>
                        </div>
                        <div class="sf-research-authors">Nuttall FQ. Nutr Today. 2015</div>
                        <div class="sf-research-description">
                            Comprehensive review of BMI as a health assessment tool, including its applications, limitations, and relationship to disease risk.
                        </div>
                    </div>
                </div>

                <div class="sf-research-card">
                    <div class="sf-research-number">2</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://academic.oup.com/ajcn/article/99/4/875/4637859" target="_blank" rel="dofollow noopener">
                                BMI and all-cause mortality in older adults: a meta-analysis
                            </a>
                        </div>
                        <div class="sf-research-authors">Winter JE, et al. Am J Clin Nutr. 2014</div>
                        <div class="sf-research-description">
                            Meta-analysis finding that optimal BMI for adults 65+ is 23-28, slightly higher than standard healthy range.
                        </div>
                    </div>
                </div>

                <div class="sf-research-card">
                    <div class="sf-research-number">3</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8920809/" target="_blank" rel="dofollow noopener">
                                Body Mass Index (BMI): A Screening Tool Analysis
                            </a>
                        </div>
                        <div class="sf-research-authors">Khanna D, et al. Cureus. 2022</div>
                        <div class="sf-research-description">
                            Analysis of BMI as a screening tool for identifying health risks in clinical practice.
                        </div>
                    </div>
                </div>

                <div class="sf-research-card">
                    <div class="sf-research-number">4</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://bmchealthservres.biomedcentral.com/articles/10.1186/s12913-019-4577-0" target="_blank" rel="dofollow noopener">
                                Body mass index and lifetime healthcare utilization
                            </a>
                        </div>
                        <div class="sf-research-authors">Edwards CH, et al. BMC Health Serv Res. 2019</div>
                        <div class="sf-research-description">
                            Study examining the relationship between BMI and healthcare costs across the lifespan.
                        </div>
                    </div>
                </div>

                <div class="sf-research-card">
                    <div class="sf-research-number">5</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://pubmed.ncbi.nlm.nih.gov/2089774/" target="_blank" rel="dofollow noopener">
                                Body mass index as a measure of body fatness: age- and sex-specific prediction formulas
                            </a>
                        </div>
                        <div class="sf-research-authors">Deurenberg P, et al. Br J Nutr. 1991</div>
                        <div class="sf-research-description">
                            Original research establishing the Deurenberg formula for estimating body fat percentage from BMI, age, and gender.
                        </div>
                    </div>
                </div>

                <div class="sf-research-card">
                    <div class="sf-research-number">6</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://academic.oup.com/aje/article/180/3/288/2739097" target="_blank" rel="dofollow noopener">
                                Body Mass Index Categories in Observational Studies of Weight and Risk of Death
                            </a>
                        </div>
                        <div class="sf-research-authors">Flegal KM, et al. Am J Epidemiol. 2014</div>
                        <div class="sf-research-description">
                            Analysis of BMI categories and mortality risk across large observational studies.
                        </div>
                    </div>
                </div>

                <div class="sf-research-card">
                    <div class="sf-research-number">7</div>
                    <div class="sf-research-content">
                        <div class="sf-research-title">
                            <a href="https://academic.oup.com/ajcn/article/72/3/694/4729363" target="_blank" rel="dofollow noopener">
                                Healthy percentage body fat ranges: an approach for developing guidelines based on BMI
                            </a>
                        </div>
                        <div class="sf-research-authors">Gallagher D, et al. Am J Clin Nutr. 2000</div>
                        <div class="sf-research-description">
                            Research establishing healthy body fat percentage ranges for different age groups and genders.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Disclaimer -->
        <div class="sf-seo-section">
            <div class="sf-disclaimer-box">
                <h3>‚ö†Ô∏è Medical Disclaimer</h3>
                <p>
                    This BMI calculator is provided for educational and informational purposes only. It is a screening tool, not a diagnostic instrument. 
                    BMI does not directly measure body fat percentage, muscle mass, or overall health status.
                </p>
                <br>
                <p>
                    Always consult with qualified healthcare professionals, registered dietitians, or certified nutritionists before making significant changes to your diet, 
                    exercise routine, or lifestyle based on BMI results. This is especially important if you have pre-existing health conditions, are pregnant or breastfeeding, 
                    are taking medications, or have a history of eating disorders.
                </p>
                <br>
                <p>
                    Individual health assessments should consider multiple factors beyond BMI, including family history, lifestyle, fitness level, body composition, 
                    and overall well-being. The calculations and recommendations provided are general guidelines and may not be appropriate for everyone.
                </p>
            </div>
            </div>
        </div>
    </div>

    <!-- SEO Content Styles -->
    <style>
        .sf-calculator-wrapper {
            --primary-blue: #1E40AF !important;
            --secondary-blue: #2563EB !important;
            --accent-blue: #3B82F6 !important;
            --light-blue: #EBF8FF !important;
            --bg-gradient: linear-gradient(135deg, #F8FAFC, #F1F5F9) !important;
            --text-primary: #0F172A !important;
            --text-secondary: #334155 !important;
            --text-muted: #64748B !important;
            --border-color: #E2E8F0 !important;
            --card-bg: #FFFFFF !important;
            
            background: var(--bg-gradient) !important;
            color: var(--text-primary) !important;
            line-height: 1.6 !important;
            padding: 20px !important;
        }

        .sf-seo-wrapper {
            max-width: 1200px !important;
            margin: 40px auto !important;
            padding: 0 20px !important;
        }

        .sf-seo-section {
            margin: 30px 0 !important;
            padding: 30px !important;
            background: var(--card-bg) !important;
            border-radius: 16px !important;
            border: 1px solid var(--border-color) !important;
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.08) !important;
        }

        .sf-section-heading {
            font-size: 32px !important;
            font-weight: 700 !important;
            color: white !important;
            margin-bottom: 25px !important;
            text-align: center !important;
            padding: 20px !important;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
            border-radius: 12px !important;
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.2) !important;
        }

        .sf-content-grid {
            display: grid !important;
            grid-template-columns: 1fr !important;
            gap: 20px !important;
            margin-top: 20px !important;
        }

        @media (min-width: 768px) {
            .sf-content-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }

        .sf-content-card {
            background: linear-gradient(145deg, #F8FAFC, var(--card-bg)) !important;
            padding: 25px !important;
            border-radius: 12px !important;
            border: 2px solid var(--border-color) !important;
            transition: all 0.3s ease !important;
        }

        .sf-content-card:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 8px 24px rgba(30, 64, 175, 0.12) !important;
            border-color: var(--accent-blue) !important;
        }

        .sf-content-card h3 {
            color: var(--primary-blue) !important;
            font-size: 22px !important;
            font-weight: 700 !important;
            margin-bottom: 16px !important;
            padding-bottom: 10px !important;
            border-bottom: 2px solid var(--light-blue) !important;
        }

        .sf-content-card p {
            color: var(--text-secondary) !important;
            line-height: 1.8 !important;
            margin: 0 !important;
            font-size: 16px !important;
        }

        .sf-content-card a {
            color: var(--primary-blue) !important;
            text-decoration: none !important;
            font-weight: 600 !important;
        }

        .sf-content-card a:hover {
            text-decoration: underline !important;
        }

        /* Formula Styles */
        .sf-formula-container {
            display: grid !important;
            gap: 25px !important;
            margin-top: 20px !important;
        }

        @media (min-width: 768px) {
            .sf-formula-container {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }

        .sf-formula-card {
            background: var(--card-bg) !important;
            border: 2px solid var(--primary-blue) !important;
            border-radius: 16px !important;
            overflow: hidden !important;
            transition: all 0.3s ease !important;
        }

        .sf-formula-card:hover {
            transform: translateY(-4px) !important;
            box-shadow: 0 12px 32px rgba(30, 64, 175, 0.15) !important;
        }

        .sf-formula-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
            color: white !important;
            padding: 18px 25px !important;
            font-size: 18px !important;
            font-weight: 700 !important;
            text-align: center !important;
        }

        .sf-formula-body {
            padding: 25px !important;
        }

        .sf-formula-item {
            background: var(--light-blue) !important;
            border: 1px solid var(--border-color) !important;
            border-radius: 12px !important;
            padding: 18px !important;
            margin-bottom: 16px !important;
        }

        .sf-formula-item:last-child {
            margin-bottom: 0 !important;
        }

        .sf-formula-label {
            font-size: 16px !important;
            font-weight: 700 !important;
            color: var(--primary-blue) !important;
            margin-bottom: 10px !important;
        }

        .sf-formula-text {
            background: var(--text-primary) !important;
            color: white !important;
            padding: 14px 18px !important;
            border-radius: 8px !important;
            font-family: 'Courier New', monospace !important;
            font-size: 15px !important;
            font-weight: 600 !important;
            letter-spacing: 0.5px !important;
            overflow-x: auto !important;
            line-height: 1.6 !important;
        }

        .sf-formula-note {
            background: #D1FAE5 !important;
            border: 1px solid #059669 !important;
            border-radius: 8px !important;
            padding: 12px 16px !important;
            font-size: 14px !important;
            font-weight: 600 !important;
            color: #065F46 !important;
            text-align: center !important;
            margin-top: 12px !important;
        }

        /* Table Styles */
        .sf-table-wrapper {
            overflow-x: auto !important;
            margin: 20px 0 !important;
            border-radius: 12px !important;
            border: 2px solid var(--border-color) !important;
        }

        .sf-standards-table {
            width: 100% !important;
            border-collapse: collapse !important;
            background: var(--card-bg) !important;
            font-size: 15px !important;
        }

        .sf-standards-table th,
        .sf-standards-table td {
            padding: 14px 16px !important;
            text-align: left !important;
            border-bottom: 1px solid var(--border-color) !important;
        }

        .sf-standards-table th {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
            color: white !important;
            font-weight: 600 !important;
            font-size: 14px !important;
        }

        .sf-standards-table td {
            color: var(--text-secondary) !important;
        }

        .sf-standards-note {
            margin-top: 16px !important;
            padding: 14px 18px !important;
            background: var(--light-blue) !important;
            border-radius: 8px !important;
            border-left: 4px solid var(--primary-blue) !important;
            font-size: 15px !important;
            color: var(--text-secondary) !important;
            line-height: 1.7 !important;
        }

        .sf-standards-note strong {
            color: var(--primary-blue) !important;
        }

        /* Research Styles */
        .sf-research-container {
            display: grid !important;
            gap: 20px !important;
            margin-top: 20px !important;
        }

        .sf-research-card {
            display: flex !important;
            gap: 20px !important;
            background: var(--card-bg) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            border: 2px solid var(--border-color) !important;
            transition: all 0.3s ease !important;
        }

        .sf-research-card:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 8px 20px rgba(30, 64, 175, 0.12) !important;
            border-color: var(--primary-blue) !important;
        }

        .sf-research-number {
            flex-shrink: 0 !important;
            width: 48px !important;
            height: 48px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
            color: white !important;
            font-size: 20px !important;
            font-weight: 700 !important;
            border-radius: 10px !important;
        }

        .sf-research-content {
            flex: 1 !important;
        }

        .sf-research-title {
            font-size: 16px !important;
            font-weight: 600 !important;
            margin-bottom: 8px !important;
        }

        .sf-research-title a {
            color: var(--primary-blue) !important;
            text-decoration: none !important;
        }

        .sf-research-title a:hover {
            text-decoration: underline !important;
        }

        .sf-research-authors {
            font-size: 13px !important;
            color: var(--text-muted) !important;
            font-style: italic !important;
            margin-bottom: 10px !important;
        }

        .sf-research-description {
            font-size: 14px !important;
            color: var(--text-secondary) !important;
            line-height: 1.6 !important;
        }

        /* Disclaimer Styles */
        .sf-disclaimer-box {
            background: linear-gradient(145deg, #FEF3C7, #FDE68A) !important;
            border: 2px solid #D97706 !important;
            border-radius: 12px !important;
            padding: 25px !important;
        }

        .sf-disclaimer-box h3 {
            color: #92400E !important;
            font-size: 20px !important;
            font-weight: 700 !important;
            margin-bottom: 15px !important;
        }

        .sf-disclaimer-box p {
            color: #78350F !important;
            line-height: 1.8 !important;
            font-size: 15px !important;
            margin: 0 !important;
        }

        /* Image Styles */
        .sf-image-container {
            margin: 25px auto !important;
            text-align: center !important;
            padding: 0 !important;
        }

        .sf-content-image {
            max-width: 100% !important;
            height: auto !important;
            border-radius: 12px !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
            border: 1px solid var(--border-color) !important;
        }

        /* Progress History Styles */
        .bmi-history-container {
            background: var(--card-bg) !important;
            border-radius: 16px !important;
            padding: 30px !important;
            margin: 30px 0 !important;
            box-shadow: 0 8px 24px rgba(30, 64, 175, 0.15) !important;
            border: 2px solid var(--primary-blue) !important;
        }

        .bmi-history-header {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            margin-bottom: 25px !important;
            padding-bottom: 15px !important;
            border-bottom: 2px solid var(--border-color) !important;
        }

        .bmi-history-header h3 {
            font-size: 26px !important;
            font-weight: 700 !important;
            color: var(--primary-blue) !important;
            margin: 0 !important;
        }

        .bmi-close-history {
            background: var(--error-color) !important;
            color: white !important;
            border: none !important;
            width: 32px !important;
            height: 32px !important;
            border-radius: 50% !important;
            font-size: 20px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
        }

        .bmi-close-history:hover {
            background: #B91C1C !important;
            transform: scale(1.1) !important;
        }

        .bmi-history-stats {
            display: grid !important;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)) !important;
            gap: 20px !important;
            margin-bottom: 30px !important;
        }

        .bmi-stat-card {
            background: linear-gradient(145deg, #F8FAFC, #FFFFFF) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            text-align: center !important;
            border: 2px solid var(--border-color) !important;
            transition: all 0.3s ease !important;
        }

        .bmi-stat-card:hover {
            transform: translateY(-4px) !important;
            box-shadow: 0 8px 20px rgba(30, 64, 175, 0.15) !important;
            border-color: var(--primary-blue) !important;
        }

        .bmi-stat-icon {
            font-size: 32px !important;
            margin-bottom: 10px !important;
        }

        .bmi-stat-label {
            font-size: 13px !important;
            color: var(--text-secondary) !important;
            margin-bottom: 8px !important;
            font-weight: 600 !important;
        }

        .bmi-stat-value {
            font-size: 24px !important;
            font-weight: 800 !important;
            color: var(--primary-blue) !important;
        }

        .bmi-chart-container {
            background: white !important;
            padding: 25px !important;
            border-radius: 12px !important;
            margin-bottom: 30px !important;
            border: 1px solid var(--border-color) !important;
        }

        .bmi-history-table {
            background: white !important;
            padding: 20px !important;
            border-radius: 12px !important;
            border: 1px solid var(--border-color) !important;
        }

        .bmi-history-table h4 {
            font-size: 18px !important;
            font-weight: 700 !important;
            color: var(--text-primary) !important;
            margin-bottom: 15px !important;
        }

        .bmi-history-actions {
            display: flex !important;
            gap: 10px !important;
            margin-bottom: 15px !important;
            flex-wrap: wrap !important;
        }

        .bmi-small-btn {
            display: inline-flex !important;
            align-items: center !important;
            gap: 6px !important;
            padding: 8px 16px !important;
            background: var(--primary-blue) !important;
            color: white !important;
            border: none !important;
            border-radius: 6px !important;
            font-size: 13px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
        }

        .bmi-small-btn:hover {
            background: var(--secondary-blue) !important;
            transform: translateY(-2px) !important;
        }

        .bmi-danger-btn {
            background: var(--error-color) !important;
        }

        .bmi-danger-btn:hover {
            background: #B91C1C !important;
        }

        .bmi-history-entries {
            max-height: 400px !important;
            overflow-y: auto !important;
        }

        .bmi-history-entry {
            display: grid !important;
            grid-template-columns: 120px 100px 80px 80px 80px auto !important;
            gap: 15px !important;
            padding: 12px !important;
            border-bottom: 1px solid var(--border-color) !important;
            font-size: 14px !important;
            align-items: center !important;
        }

        .bmi-history-entry:hover {
            background: var(--light-blue) !important;
        }

        .bmi-history-header-row {
            font-weight: 700 !important;
            color: var(--primary-blue) !important;
            background: var(--light-blue) !important;
            border-radius: 6px !important;
        }

        /* Goal Setting Styles */
        .bmi-goal-container {
            background: linear-gradient(145deg, #FFFFFF, #F8FAFC) !important;
            border-radius: 16px !important;
            padding: 30px !important;
            margin: 30px 0 !important;
            box-shadow: 0 8px 24px rgba(30, 64, 175, 0.15) !important;
            border: 2px solid var(--accent-blue) !important;
        }

        .bmi-goal-header {
            text-align: center !important;
            margin-bottom: 30px !important;
        }

        .bmi-goal-header h3 {
            font-size: 28px !important;
            font-weight: 700 !important;
            color: var(--primary-blue) !important;
            margin-bottom: 10px !important;
        }

        .bmi-goal-header p {
            color: var(--text-secondary) !important;
            font-size: 16px !important;
        }

        .bmi-goal-form {
            background: white !important;
            padding: 25px !important;
            border-radius: 12px !important;
            margin-bottom: 25px !important;
            border: 1px solid var(--border-color) !important;
        }

        .bmi-goal-input-group {
            margin-bottom: 20px !important;
        }

        .bmi-goal-input-group label {
            display: block !important;
            font-weight: 600 !important;
            color: var(--text-primary) !important;
            margin-bottom: 8px !important;
            font-size: 14px !important;
        }

        .bmi-goal-input-row {
            display: flex !important;
            gap: 10px !important;
        }

        .bmi-goal-input {
            flex: 1 !important;
            padding: 12px 16px !important;
            border: 2px solid var(--border-color) !important;
            border-radius: 8px !important;
            font-size: 16px !important;
            transition: all 0.3s ease !important;
        }

        .bmi-goal-input:focus {
            outline: none !important;
            border-color: var(--primary-blue) !important;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1) !important;
        }

        .bmi-goal-select {
            padding: 12px 16px !important;
            border: 2px solid var(--border-color) !important;
            border-radius: 8px !important;
            font-size: 14px !important;
            background: white !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            width: 100% !important;
        }

        .bmi-goal-select:focus {
            outline: none !important;
            border-color: var(--primary-blue) !important;
        }

        .bmi-goal-calculate-btn {
            width: 100% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 10px !important;
            padding: 16px 24px !important;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue)) !important;
            color: white !important;
            border: none !important;
            border-radius: 10px !important;
            font-size: 16px !important;
            font-weight: 700 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3) !important;
        }

        .bmi-goal-calculate-btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(30, 64, 175, 0.4) !important;
        }

        .bmi-goal-results {
            background: white !important;
            padding: 30px !important;
            border-radius: 12px !important;
            border: 2px solid var(--primary-blue) !important;
        }

        .bmi-goal-summary {
            display: grid !important;
            grid-template-columns: 200px 1fr !important;
            gap: 30px !important;
            margin-bottom: 30px !important;
            align-items: center !important;
        }

        .bmi-goal-progress-ring {
            width: 200px !important;
            height: 200px !important;
        }

        .bmi-goal-progress-ring svg {
            width: 100% !important;
            height: 100% !important;
        }

        .bmi-goal-details {
            display: flex !important;
            flex-direction: column !important;
            gap: 12px !important;
        }

        .bmi-goal-detail-item {
            display: flex !important;
            justify-content: space-between !important;
            padding: 10px 0 !important;
            border-bottom: 1px solid var(--border-color) !important;
        }

        .bmi-goal-label {
            font-weight: 600 !important;
            color: var(--text-secondary) !important;
            font-size: 14px !important;
        }

        .bmi-goal-value {
            font-weight: 700 !important;
            color: var(--text-primary) !important;
            font-size: 16px !important;
        }

        .bmi-goal-value.highlight {
            color: var(--primary-blue) !important;
            font-size: 18px !important;
        }

        .bmi-milestone-section {
            margin: 30px 0 !important;
        }

        .bmi-milestone-section h4 {
            font-size: 20px !important;
            font-weight: 700 !important;
            color: var(--text-primary) !important;
            margin-bottom: 20px !important;
        }

        .bmi-milestones-grid {
            display: grid !important;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)) !important;
            gap: 15px !important;
        }

        .bmi-milestone-card {
            background: linear-gradient(145deg, #F8FAFC, #FFFFFF) !important;
            padding: 20px !important;
            border-radius: 10px !important;
            border: 2px solid var(--border-color) !important;
            text-align: center !important;
            transition: all 0.3s ease !important;
        }

        .bmi-milestone-card:hover {
            border-color: var(--primary-blue) !important;
            transform: translateY(-4px) !important;
            box-shadow: 0 6px 16px rgba(30, 64, 175, 0.15) !important;
        }

        .bmi-milestone-card.achieved {
            background: linear-gradient(145deg, #D1FAE5, #A7F3D0) !important;
            border-color: var(--success-color) !important;
        }

        .bmi-milestone-week {
            font-size: 13px !important;
            color: var(--text-muted) !important;
            font-weight: 600 !important;
            margin-bottom: 8px !important;
        }

        .bmi-milestone-weight {
            font-size: 22px !important;
            font-weight: 800 !important;
            color: var(--primary-blue) !important;
            margin-bottom: 5px !important;
        }

        .bmi-milestone-date {
            font-size: 12px !important;
            color: var(--text-secondary) !important;
        }

        .bmi-goal-tips {
            background: var(--light-blue) !important;
            padding: 20px !important;
            border-radius: 10px !important;
            margin: 25px 0 !important;
        }

        .bmi-goal-tips h4 {
            font-size: 18px !important;
            font-weight: 700 !important;
            color: var(--text-primary) !important;
            margin-bottom: 15px !important;
        }

        .bmi-tip-item {
            display: flex !important;
            gap: 12px !important;
            margin-bottom: 12px !important;
            padding: 12px !important;
            background: white !important;
            border-radius: 8px !important;
            border-left: 4px solid var(--primary-blue) !important;
        }

        .bmi-tip-icon {
            font-size: 24px !important;
            flex-shrink: 0 !important;
        }

        .bmi-tip-text {
            font-size: 14px !important;
            color: var(--text-secondary) !important;
            line-height: 1.6 !important;
        }

        .bmi-save-goal-btn {
            width: 100% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 10px !important;
            padding: 16px 24px !important;
            background: var(--success-color) !important;
            color: white !important;
            border: none !important;
            border-radius: 10px !important;
            font-size: 16px !important;
            font-weight: 700 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            margin-top: 20px !important;
        }

        .bmi-save-goal-btn:hover {
            background: #047857 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 20px rgba(5, 150, 105, 0.4) !important;
        }

        .bmi-save-btn {
            background: var(--success-color) !important;
            border-color: var(--success-color) !important;
        }

        .bmi-save-btn:hover {
            background: #047857 !important;
            border-color: #047857 !important;
        }

        .bmi-history-btn {
            background: var(--warning-color) !important;
            border-color: var(--warning-color) !important;
        }

        .bmi-history-btn:hover {
            background: #B45309 !important;
            border-color: #B45309 !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sf-section-heading {
                font-size: 24px !important;
                padding: 15px !important;
            }

            .sf-content-card h3 {
                font-size: 18px !important;
            }

            .sf-formula-container {
                grid-template-columns: 1fr !important;
            }

            .sf-seo-wrapper {
                padding: 0 15px !important;
            }

            .sf-seo-section {
                padding: 20px !important;
            }

            .sf-standards-table {
                font-size: 13px !important;
            }

            .sf-standards-table th,
            .sf-standards-table td {
                padding: 10px 8px !important;
            }

            .bmi-goal-summary {
                grid-template-columns: 1fr !important;
            }

            .bmi-goal-progress-ring {
                margin: 0 auto !important;
            }

            .bmi-milestones-grid {
                grid-template-columns: 1fr !important;
            }

            .bmi-history-entry {
                grid-template-columns: 1fr !important;
                gap: 8px !important;
            }

            .bmi-stat-card {
                min-width: 150px !important;
            }
        }
    </style>

    <!-- Chart.js Library for Progress Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Progress Tracking & Goal Setting JavaScript -->
    <script>
    // Global variables for tracking
    let bmiHistory = [];
    let currentGoal = null;
    let progressChart = null;
    let latestBMIData = null;

    // Load data from localStorage on page load
    (function() {
        const savedHistory = localStorage.getItem('bmiHistory');
        if (savedHistory) {
            bmiHistory = JSON.parse(savedHistory);
        }

        const savedGoal = localStorage.getItem('bmiGoal');
        if (savedGoal) {
            currentGoal = JSON.parse(savedGoal);
        }
    })();

    // Save Progress Function
    function saveProgress() {
        if (!latestBMIData) {
            alert('Please calculate your BMI first before saving progress.');
            return;
        }

        const entry = {
            date: new Date().toISOString(),
            weight: latestBMIData.weightKg,
            heightM: latestBMIData.heightM,
            bmi: latestBMIData.bmi,
            category: latestBMIData.category,
            bodyFat: latestBMIData.bodyFat,
            age: latestBMIData.age,
            gender: latestBMIData.gender,
            unit: currentWeightUnit
        };

        bmiHistory.unshift(entry); // Add to beginning
        localStorage.setItem('bmiHistory', JSON.stringify(bmiHistory));

        alert('‚úÖ Progress saved successfully! View your history to track your journey.');
        
        // Auto-show history after saving
        setTimeout(() => toggleHistory(), 500);
    }

    // Toggle History Display
    function toggleHistory() {
        const historySection = document.getElementById('bmiHistorySection');
        const isVisible = historySection.style.display !== 'none';
        
        if (isVisible) {
            historySection.style.display = 'none';
        } else {
            historySection.style.display = 'block';
            updateHistoryDisplay();
        }
    }

    // Update History Display
    function updateHistoryDisplay() {
        if (bmiHistory.length === 0) {
            document.getElementById('historyTableContent').innerHTML = '<p style="text-align: center; color: #64748B; padding: 40px;">No history yet. Start tracking your progress by clicking "Save Progress" after calculating your BMI.</p>';
            return;
        }

        // Update stats
        document.getElementById('totalEntries').textContent = bmiHistory.length;
        
        const firstEntry = bmiHistory[bmiHistory.length - 1];
        const lastEntry = bmiHistory[0];
        
        const weightChange = lastEntry.weight - firstEntry.weight;
        const weightChangeDisplay = weightChange >= 0 ? `+${weightChange.toFixed(1)} kg` : `${weightChange.toFixed(1)} kg`;
        document.getElementById('weightChange').textContent = weightChangeDisplay;
        document.getElementById('weightChange').style.color = weightChange > 0 ? '#DC2626' : '#059669';
        
        const bmiChange = lastEntry.bmi - firstEntry.bmi;
        const bmiChangeDisplay = bmiChange >= 0 ? `+${bmiChange.toFixed(1)}` : `${bmiChange.toFixed(1)}`;
        document.getElementById('bmiChange').textContent = bmiChangeDisplay;
        document.getElementById('bmiChange').style.color = bmiChange > 0 ? '#DC2626' : '#059669';
        
        const trackingSince = new Date(firstEntry.date).toLocaleDateString();
        document.getElementById('trackingSince').textContent = trackingSince;

        // Update chart
        updateProgressChart();

        // Update table
        let tableHTML = '<div class="bmi-history-entries">';
        tableHTML += '<div class="bmi-history-entry bmi-history-header-row">';
        tableHTML += '<div>Date</div><div>Weight</div><div>BMI</div><div>Body Fat</div><div>Category</div><div>Actions</div>';
        tableHTML += '</div>';

        bmiHistory.forEach((entry, index) => {
            const date = new Date(entry.date).toLocaleDateString();
            const weight = entry.unit === 'kg' ? `${entry.weight.toFixed(1)} kg` : `${(entry.weight * 2.20462).toFixed(1)} lbs`;
            
            tableHTML += `<div class="bmi-history-entry">`;
            tableHTML += `<div>${date}</div>`;
            tableHTML += `<div>${weight}</div>`;
            tableHTML += `<div>${entry.bmi.toFixed(1)}</div>`;
            tableHTML += `<div>${entry.bodyFat ? entry.bodyFat.toFixed(1) + '%' : 'N/A'}</div>`;
            tableHTML += `<div>${entry.category}</div>`;
            tableHTML += `<div><button class="bmi-small-btn bmi-danger-btn" onclick="deleteEntry(${index})">Delete</button></div>`;
            tableHTML += `</div>`;
        });

        tableHTML += '</div>';
        document.getElementById('historyTableContent').innerHTML = tableHTML;
    }

    // Update Progress Chart
    function updateProgressChart() {
        const ctx = document.getElementById('bmiProgressChart');
        if (!ctx) return;

        // Prepare data (reverse to show oldest to newest)
        const reversed = [...bmiHistory].reverse();
        const labels = reversed.map(entry => new Date(entry.date).toLocaleDateString());
        const bmiData = reversed.map(entry => entry.bmi);
        const weightData = reversed.map(entry => entry.weight);

        if (progressChart) {
            progressChart.destroy();
        }

        progressChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'BMI',
                        data: bmiData,
                        borderColor: '#1E40AF',
                        backgroundColor: 'rgba(30, 64, 175, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        yAxisID: 'y'
                    },
                    {
                        label: 'Weight (kg)',
                        data: weightData,
                        borderColor: '#059669',
                        backgroundColor: 'rgba(5, 150, 105, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        yAxisID: 'y1'
                    }
                ]
            },
            options: {
                responsive: true,
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Your BMI & Weight Progress',
                        font: { size: 18, weight: 'bold' },
                        color: '#0F172A'
                    },
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        type: 'linear',
                        display: true,
                        position: 'left',
                        title: {
                            display: true,
                            text: 'BMI',
                            font: { weight: 'bold' }
                        }
                    },
                    y1: {
                        type: 'linear',
                        display: true,
                        position: 'right',
                        title: {
                            display: true,
                            text: 'Weight (kg)',
                            font: { weight: 'bold' }
                        },
                        grid: {
                            drawOnChartArea: false
                        }
                    }
                }
            }
        });
    }

    // Delete Entry
    function deleteEntry(index) {
        if (confirm('Are you sure you want to delete this entry?')) {
            bmiHistory.splice(index, 1);
            localStorage.setItem('bmiHistory', JSON.stringify(bmiHistory));
            updateHistoryDisplay();
        }
    }

    // Clear History
    function clearHistory() {
        if (confirm('‚ö†Ô∏è Are you sure you want to delete ALL your progress history? This cannot be undone!')) {
            bmiHistory = [];
            localStorage.removeItem('bmiHistory');
            updateHistoryDisplay();
            alert('‚úÖ History cleared successfully.');
        }
    }

    // Export History
    function exportHistory() {
        if (bmiHistory.length === 0) {
            alert('No history to export.');
            return;
        }

        let csv = 'Date,Weight (kg),BMI,Body Fat %,Category,Age,Gender\n';
        bmiHistory.forEach(entry => {
            const date = new Date(entry.date).toLocaleDateString();
            csv += `${date},${entry.weight.toFixed(2)},${entry.bmi.toFixed(2)},${entry.bodyFat ? entry.bodyFat.toFixed(2) : 'N/A'},${entry.category},${entry.age},${entry.gender}\n`;
        });

        const blob = new Blob([csv], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `BMI-History-${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
    }

    // Convert Goal Unit
    function convertGoalUnit() {
        const goalWeight = parseFloat(document.getElementById('goalWeight').value);
        const unit = document.getElementById('goalWeightUnit').value;
        
        if (!goalWeight) return;
        
        if (unit === 'lbs') {
            document.getElementById('goalWeight').value = (goalWeight * 2.20462).toFixed(1);
        } else {
            document.getElementById('goalWeight').value = (goalWeight / 2.20462).toFixed(1);
        }
    }

    // Calculate Goal
    function calculateGoal() {
        if (!latestBMIData) {
            alert('Please calculate your BMI first before setting a goal.');
            return;
        }

        let goalWeight = parseFloat(document.getElementById('goalWeight').value);
        const goalWeightUnit = document.getElementById('goalWeightUnit').value;
        const weeklyGoal = parseFloat(document.getElementById('weeklyGoal').value);

        if (!goalWeight || goalWeight <= 0) {
            alert('Please enter a valid goal weight.');
            return;
        }

        // Convert to kg if needed
        if (goalWeightUnit === 'lbs') {
            goalWeight = goalWeight / 2.20462;
        }

        const currentWeight = latestBMIData.weightKg;
        const weightDiff = goalWeight - currentWeight;
        const isLosing = weightDiff < 0;
        
        // Calculate timeline
        const weeksToGoal = Math.abs(weightDiff / weeklyGoal);
        const targetDate = new Date();
        targetDate.setDate(targetDate.getDate() + (weeksToGoal * 7));

        // Calculate calorie adjustment (1 kg ‚âà 7700 calories)
        const caloriesPerDay = (weeklyGoal * 7700) / 7;

        // Update display
        document.getElementById('goalResults').style.display = 'block';
        
        const displayUnit = currentWeightUnit;
        const currentWeightDisplay = displayUnit === 'kg' 
            ? `${currentWeight.toFixed(1)} kg` 
            : `${(currentWeight * 2.20462).toFixed(1)} lbs`;
        const goalWeightDisplay = displayUnit === 'kg' 
            ? `${goalWeight.toFixed(1)} kg` 
            : `${(goalWeight * 2.20462).toFixed(1)} lbs`;
        const weightDiffDisplay = displayUnit === 'kg' 
            ? `${Math.abs(weightDiff).toFixed(1)} kg` 
            : `${(Math.abs(weightDiff) * 2.20462).toFixed(1)} lbs`;

        document.getElementById('currentWeightDisplay').textContent = currentWeightDisplay;
        document.getElementById('goalWeightDisplay').textContent = goalWeightDisplay;
        document.getElementById('weightDiffDisplay').textContent = `${isLosing ? 'Lose' : 'Gain'} ${weightDiffDisplay}`;
        document.getElementById('timeToGoalDisplay').textContent = `${Math.ceil(weeksToGoal)} weeks`;
        document.getElementById('targetDateDisplay').textContent = targetDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
        document.getElementById('calorieAdjustDisplay').textContent = `${isLosing ? '' : '+'}${Math.round(caloriesPerDay)} cal/day`;

        // Update progress ring
        const percentComplete = 0; // Starting at 0%
        document.getElementById('goalPercentText').textContent = `${percentComplete}%`;
        const circle = document.getElementById('goalProgressCircle');
        const circumference = 534;
        circle.style.strokeDashoffset = circumference - (circumference * percentComplete / 100);

        // Generate milestones (every 2 weeks or 25% progress)
        generateMilestones(currentWeight, goalWeight, weeklyGoal, weeksToGoal);

        // Generate tips
        generateGoalTips(isLosing, caloriesPerDay, weeklyGoal);

        // Scroll to results
        document.getElementById('goalResults').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Generate Milestones
    function generateMilestones(currentWeight, goalWeight, weeklyRate, totalWeeks) {
        const milestonesContainer = document.getElementById('milestonesContainer');
        milestonesContainer.innerHTML = '';

        const numMilestones = Math.min(5, Math.ceil(totalWeeks / 2)); // Max 5 milestones
        const weightPerMilestone = (goalWeight - currentWeight) / numMilestones;
        const weeksPerMilestone = totalWeeks / numMilestones;

        for (let i = 1; i <= numMilestones; i++) {
            const milestoneWeight = currentWeight + (weightPerMilestone * i);
            const milestoneWeek = Math.ceil(weeksPerMilestone * i);
            const milestoneDate = new Date();
            milestoneDate.setDate(milestoneDate.getDate() + (milestoneWeek * 7));

            const milestoneHTML = `
                <div class="bmi-milestone-card">
                    <div class="bmi-milestone-week">Week ${milestoneWeek}</div>
                    <div class="bmi-milestone-weight">${currentWeightUnit === 'kg' ? milestoneWeight.toFixed(1) + ' kg' : (milestoneWeight * 2.20462).toFixed(1) + ' lbs'}</div>
                    <div class="bmi-milestone-date">${milestoneDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</div>
                </div>
            `;
            milestonesContainer.innerHTML += milestoneHTML;
        }
    }

    // Generate Goal Tips
    function generateGoalTips(isLosing, dailyCalories, weeklyRate) {
        const tipsContainer = document.getElementById('goalTipsContainer');
        
        const tips = isLosing ? [
            { icon: 'üçΩÔ∏è', text: `Create a ${Math.round(Math.abs(dailyCalories))} calorie deficit daily through diet and exercise combined.` },
            { icon: 'üèÉ', text: `Add 30-45 minutes of cardio 4-5 times per week to boost calorie burn.` },
            { icon: 'üí™', text: `Include strength training 2-3 times per week to preserve muscle mass during weight loss.` },
            { icon: 'üíß', text: `Drink at least 8-10 glasses of water daily to support metabolism and reduce hunger.` },
            { icon: 'ü•ó', text: `Focus on high-protein foods (chicken, fish, eggs, legumes) to stay full longer and maintain muscle.` },
            { icon: 'üò¥', text: `Get 7-9 hours of quality sleep - poor sleep increases hunger hormones and slows weight loss.` },
            { icon: 'üìä', text: `Weigh yourself weekly at the same time (morning, after bathroom) to track progress consistently.` }
        ] : [
            { icon: 'üçΩÔ∏è', text: `Add ${Math.round(dailyCalories)} extra calories daily through nutrient-dense foods.` },
            { icon: 'üí™', text: `Focus on strength training 4-5 times per week to build muscle mass.` },
            { icon: 'ü•©', text: `Consume 1.6-2.2g of protein per kg body weight daily to support muscle growth.` },
            { icon: 'ü•ú', text: `Include healthy fats (nuts, avocado, olive oil) to increase calorie intake.` },
            { icon: 'üò¥', text: `Get 8-10 hours of sleep - muscle recovery and growth happen during rest.` },
            { icon: 'üìä', text: `Track your weight weekly and adjust calories if not gaining at target rate.` }
        ];

        tipsContainer.innerHTML = tips.map(tip => `
            <div class="bmi-tip-item">
                <div class="bmi-tip-icon">${tip.icon}</div>
                <div class="bmi-tip-text">${tip.text}</div>
            </div>
        `).join('');
    }

    // Save Goal
    function saveGoal() {
        if (!latestBMIData) {
            alert('Please calculate your BMI first.');
            return;
        }

        const goalWeight = parseFloat(document.getElementById('goalWeight').value);
        if (!goalWeight) {
            alert('Please set a goal weight first.');
            return;
        }

        currentGoal = {
            goalWeight: goalWeight,
            goalWeightUnit: document.getElementById('goalWeightUnit').value,
            weeklyGoal: parseFloat(document.getElementById('weeklyGoal').value),
            startDate: new Date().toISOString(),
            startWeight: latestBMIData.weightKg
        };

        localStorage.setItem('bmiGoal', JSON.stringify(currentGoal));
        alert('üéØ Goal saved successfully! Keep tracking your progress to reach your target.');
    }

    // Modify the displayResults function to store latest BMI data
    const originalDisplayResults = displayResults;
    function displayResults(bmi, category, bodyFat, idealRange, userData) {
        // Store latest data for progress tracking
        latestBMIData = {
            bmi: bmi,
            category: category.name,
            bodyFat: bodyFat,
            weightKg: userData.weightKg,
            heightM: userData.heightM,
            age: userData.age,
            gender: userData.gender
        };

        // Call original function
        originalDisplayResults(bmi, category, bodyFat, idealRange, userData);

        // Sync goal weight unit with current unit
        document.getElementById('goalWeightUnit').value = currentWeightUnit;
    }
    </script>

</body>
</html>
